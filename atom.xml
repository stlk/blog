<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

 <title>Zápisník Josefa Rouska</title>
 <link href="https://blog.rousek.name/atom.xml" rel="self"/>
 <link href="https://blog.rousek.name/"/>
 <updated>2020-08-09T07:39:01-05:00</updated>
 <id>https://blog.rousek.name</id>
 <author>
   <name>Josef Rousek</name>
   <email>josef.rousek@gmail.com</email>
 </author>

 
 <entry>
   <title>Hi-speed request filtering using Cloudflare Workers</title>
   <link href="https://blog.rousek.name/2020/08/09/high-speed-request-filtering-using-cloudflare-workers/"/>
   <updated>2020-08-09T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2020/08/09/high-speed-request-filtering-using-cloudflare-workers</id>
   <content type="html">&lt;p&gt;Recently I was facing very interesting challenge. We distribute our app’s javascript using Cloudflare. Sometimes the &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;script&amp;gt;&lt;/code&gt; tag stays on the site after the app is uninstalled resulting in unnecessary load on our server. This means that eventually we’ll have to quickly determine whenever should the script run or not.&lt;/p&gt;

&lt;p&gt;Quite a few CDN providers now support running our code on CDN edge. I’m using it to return empty JS file for clients that uninstalled our app. Based on URL &lt;code class=&quot;highlighter-rouge&quot;&gt;https://my-awesome-app.com/static/main.js?shop=example-client.com&lt;/code&gt; I can use Cloudflare Workers and KV store to make this decision in around 1ms.&lt;/p&gt;

&lt;p&gt;I wrote following worker and assigned it to &lt;code class=&quot;highlighter-rouge&quot;&gt;my-awesome-app.com/static/main.js*&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getBlockedHostname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;myshopify_domain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;myshopify_domain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;KV_NAMESPACE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;myshopify_domain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;handleRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;URL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;myshopify_domain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;searchParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;shop&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;blocked_hostname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;getBlockedHostname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;myshopify_domain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// if KV contains key myshopify_domain we'll return empty response instead &lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;blocked_hostname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;content-type&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;application/javascript&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// else return regular response&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;respondWith&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;handleRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>Pipenv is great</title>
   <link href="https://blog.rousek.name/2020/07/16/pipenv-is-great/"/>
   <updated>2020-07-16T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2020/07/16/pipenv-is-great</id>
   <content type="html">&lt;p&gt;I wanted to write something about Pipenv for a long time. With the new release, I think it’s a good time to thank authors and maintainers of Pipfile. I started using Pipenv exactly two years ago and haven’t stopped ever since. This post is a writeup of my views from the perspective of app developer.&lt;/p&gt;

&lt;h3 id=&quot;alternatives-or-not&quot;&gt;Alternatives, or not?&lt;/h3&gt;

&lt;p&gt;With the release of Django 3.0 Pipenv had a hard time correctly resolving asgiref package, I had to add it to the &lt;code class=&quot;highlighter-rouge&quot;&gt;Pipfile&lt;/code&gt;. I thought this is where it ends so I started looking for alternatives.&lt;/p&gt;

&lt;h4 id=&quot;venv--pip--pip-tools&quot;&gt;venv + pip + pip-tools&lt;/h4&gt;

&lt;p&gt;This is just not for me. But it works for &lt;a href=&quot;https://twitter.com/AdamChainz/status/1239172374718808065&quot;&gt;others&lt;/a&gt;.&lt;/p&gt;

&lt;h4 id=&quot;poetry&quot;&gt;Poetry&lt;/h4&gt;

&lt;p&gt;Poetry is intended for libraries. But we tried it anyway. However, it doesn’t handle installing &lt;a href=&quot;https://github.com/stlk/django-toolbox/&quot;&gt;specific&lt;/a&gt; packages from git in editable mode. Thanks to &lt;a href=&quot;https://testandcode.com/119&quot;&gt;Test &amp;amp; Code podcast&lt;/a&gt; I discovered that editable installs are a feature of setuptools. I know the fault is &lt;a href=&quot;https://github.com/stlk/django-toolbox/&quot;&gt;mine&lt;/a&gt;, but I just couldn’t make it work.&lt;/p&gt;

&lt;h4 id=&quot;pyflow&quot;&gt;Pyflow&lt;/h4&gt;

&lt;p&gt;I only heard about &lt;a href=&quot;https://github.com/David-OConnor/pyflow&quot;&gt;Pyflow&lt;/a&gt; in &lt;a href=&quot;https://pythonbytes.fm/episodes/show/186/the-treebeard-will-guard-your-notebook&quot;&gt;&lt;/a&gt; but it looks promising. The nice thing is that it implements proposals that will most likely make it into python itself. It’s ticking all the boxes for me so I might give it a shot.&lt;/p&gt;

&lt;h3 id=&quot;still-using-it&quot;&gt;Still using it&lt;/h3&gt;

&lt;p&gt;Overall Pipenv is the perfect tool for my workflow. Version pinning, loading ENV variables, automatic environment creation and activation are just the chores I don’t want to worry about. I believe that package development and application development are so different tasks that I’m fine with Pipenv not adopting &lt;code class=&quot;highlighter-rouge&quot;&gt;pyproject.toml&lt;/code&gt;. However, I expect that prominent community members communicate what tool should be used for application development. From the outside, it looks like everybody is concerned about packages. Yes, making package development simple is an important goal. But in the end, most of us are just users. We’re building applications. That’s why I love Pipenv.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>My year 2019</title>
   <link href="https://blog.rousek.name/2020/03/28/my-2019/"/>
   <updated>2020-03-28T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2020/03/28/my-2019</id>
   <content type="html">&lt;p&gt;I’m quite late to the party. Actually I’ve already done my taxes. But since I’m not using Instagram anymore. I decided to post some pictures here to remind me what actually happened.&lt;/p&gt;

&lt;p&gt;We started a year by three week trip to Bali. Our first time outside Europe.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/2019-review/bali.jpg&quot; alt=&quot;&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I attended DjangoCon EU 2019: Copenhagen and met wondeful people from Django community namely &lt;a href=&quot;https://twitter.com/K_Vaiders&quot;&gt;Krišjānis Vaiders&lt;/a&gt; and &lt;a href=&quot;https://twitter.com/carltongibson&quot;&gt;Carlton Gibson&lt;/a&gt;.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/2019-review/djangocon_cph.jpg&quot; alt=&quot;&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We spent a week at &lt;a href=&quot;http://www.retreat.cz/&quot;&gt;retreat.cz&lt;/a&gt; again. Cottage with fireplace, great internet connectivity in Beskydy mountains. An awesome package!&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/2019-review/retreat.jpg&quot; alt=&quot;&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Met with friends from local community at PyCon CZ in Ostrava.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/2019-review/pycon.jpg&quot; alt=&quot;&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Attended &lt;a href=&quot;https://www.strava.com/activities/2566668380&quot;&gt;Slapský triatlon&lt;/a&gt; for the 2nd time.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/2019-review/slapy.jpg&quot; alt=&quot;&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Had a great vacation in Greece.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/2019-review/greece.jpg&quot; alt=&quot;&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Five times at protests against Babiš.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/2019-review/pochod.jpg&quot; alt=&quot;&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;books&quot;&gt;Books&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;https://www.goodreads.com/book/show/2052.The_Big_Sleep&quot;&gt;The Big Sleep&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://fabiensanglard.net/gebbdoom/&quot;&gt;Game Engine Black Book: DOOM&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://jamesclear.com/atomic-habits&quot;&gt;Atomic Habits: An Easy &amp;amp; Proven Way to Build Good Habits &amp;amp; Break Bad Ones&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.goodreads.com/book/show/222146.Masters_of_Doom&quot;&gt;Masters of Doom: How Two Guys Created an Empire and Transformed Pop Culture&lt;/a&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Speed up your reports using materialized views</title>
   <link href="https://blog.rousek.name/2020/03/07/speed-up-reports-using-materialized-views/"/>
   <updated>2020-03-07T00:00:00-06:00</updated>
   <id>https://blog.rousek.name/2020/03/07/speed-up-reports-using-materialized-views</id>
   <content type="html">&lt;p&gt;We’re collecting anonymous customer events in our Shopify app into a single table. This table grew over time to sufficiently large volume, approximately 30 million, to make our reports take too much time for large customers. The first and easiest step to a better performance I could think of is to precompute the report. Materialized views seemed like a reasonable approach. So I went ahead and asked DB specialist if it’s a good idea.&lt;/p&gt;

&lt;p&gt;Materialized views on PostgreSQL are a way to speed up your complex queries by saving the intermediate results. It’s a temporary table which can be refreshed with a single command.&lt;/p&gt;

&lt;p&gt;I’ll walk you through the process using one of the queries as an example. This is a simplified version of what the query looked like.&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;distinct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FILTER&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'view'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;views&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;bussiness_event&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;WHERE&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;shop_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;created&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timestamptz&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;created&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timestamptz&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In order to reduce number of rows we had to find a time unit that works for our use case. In our case we store metrics grouped by day, meaning we store daily reports for each &lt;code class=&quot;highlighter-rouge&quot;&gt;shop&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MATERIALIZED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VIEW&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;analytics_summary&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AS&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shop_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;created&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event_date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;distinct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FILTER&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'view'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;views&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;bussiness_event&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;by&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shop_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;created&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then to use the view we could do this.&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;views&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)::&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;views&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;analytics_summary&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;WHERE&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;shop_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;event_date&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timestamptz&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event_date&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timestamptz&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The query is almost instant but the data are stale. To keep the report live we’ve used &lt;code class=&quot;highlighter-rouge&quot;&gt;UNION ALL&lt;/code&gt; to include data for last day.&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;views&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)::&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;views&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;shop_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;created&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event_date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;distinct&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FILTER&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'view'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;views&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;bussiness_event&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;WHERE&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;created&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()::&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;interval&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'2 days'&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;UNION&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;ALL&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;shop_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;event_date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;views&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;analytics_summary&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;WHERE&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;event_date&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()::&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;interval&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'2 days'&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unioned&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;WHERE&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;shop_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;event_date&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timestamptz&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event_date&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timestamptz&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shop_id&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Are you wondering what does &lt;code class=&quot;highlighter-rouge&quot;&gt;GROUP BY 1,2&lt;/code&gt; do? Well, I did because I never saw this. It’s the equivalent of &lt;code class=&quot;highlighter-rouge&quot;&gt;GROUP BY shop_id, created::date&lt;/code&gt; .&lt;/p&gt;

&lt;p&gt;To update the view we have following query scheduled to run daily.&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;REFRESH&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MATERIALIZED&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VIEW&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;analytics_offers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>Chrome 80, iframes and cookies</title>
   <link href="https://blog.rousek.name/2020/02/01/chrome-80-iframes-and-cookies/"/>
   <updated>2020-02-01T00:00:00-06:00</updated>
   <id>https://blog.rousek.name/2020/02/01/chrome-80-iframes-and-cookies</id>
   <content type="html">&lt;p&gt;Google is always kind enough to provide us with something to do. This time it’s about Chrome defaulting cookies to &lt;a href=&quot;https://web.dev/samesite-cookies-explained/&quot;&gt;SameSite=Lax&lt;/a&gt; and a relatively new &lt;code class=&quot;highlighter-rouge&quot;&gt;SameSite=None&lt;/code&gt; option.&lt;/p&gt;

&lt;p&gt;I’m building Shopify apps using Django. The app is embedded inside stores admin meaning &lt;a href=&quot;https://help.shopify.com/en/api/guides/samesite-cookies&quot;&gt;I can’t use Strict or Lax&lt;/a&gt;. Django did the same thing and on &lt;a href=&quot;https://docs.djangoproject.com/en/dev/releases/2.1/#django-contrib-sessions&quot;&gt;August 2018&lt;/a&gt; added &lt;code class=&quot;highlighter-rouge&quot;&gt;SESSION_COOKIE_SAMESITE&lt;/code&gt; which defaults to Lax. The way I see it changing defaults on the server-side is a good step. However, this change on the browser side came just too quickly for the ecosystem to adapt. The frameworks haven’t &lt;a href=&quot;https://docs.djangoproject.com/en/dev/ref/settings/#std:setting-SESSION_COOKIE_SAMESITE&quot;&gt;caught up yet&lt;/a&gt; and even if they did they would have to consider &lt;a href=&quot;https://www.chromium.org/updates/same-site/incompatible-clients&quot;&gt;incompatible browsers&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I and &lt;a href=&quot;https://github.com/tystar86&quot;&gt;tystar&lt;/a&gt; wrote a &lt;a href=&quot;https://github.com/stlk/django-toolbox/blob/master/django_toolbox/cookies_middleware.py&quot;&gt;middleware&lt;/a&gt; for Django 2.2.x and 3.x to handle this. This middleware should be placed before any other middleware.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;MIDDLEWARE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;django_toolbox.cookies_middleware.SamesiteCookieMiddleware&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</content>
 </entry>
 
 <entry>
   <title>Forward your voicemail to Slack with Twilio</title>
   <link href="https://blog.rousek.name/2018/11/02/forward-your-voicemail-to-slack-with-twilio/"/>
   <updated>2018-11-02T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2018/11/02/forward-your-voicemail-to-slack-with-twilio</id>
   <content type="html">&lt;p&gt;This post expands on the previous one I wrote on this topic. Please refer back to &lt;a href=&quot;/2018/09/09/virtual-business-phone-number-with-twilio/&quot;&gt;Virtual support phone number with Twilio&lt;/a&gt; if you’re not familiar with Twilio.&lt;/p&gt;

&lt;p&gt;Following up from last time. We have voice-enabled phone number &lt;em&gt;+420999999999&lt;/em&gt;. Now We’ll setup call forwarding and voicemail for this number.&lt;/p&gt;

&lt;h3 id=&quot;twilio-functions&quot;&gt;Twilio Functions&lt;/h3&gt;

&lt;p&gt;Functions are a way to run your logic directly on Twilio servers. We’ll use them to construct TwiML response and then to send a message to Slack.&lt;/p&gt;

&lt;h3 id=&quot;recording-voicemail-message&quot;&gt;Recording voicemail message&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://www.twilio.com/console/runtime/functions/manage&quot;&gt;Runtime &amp;gt; Functions&lt;/a&gt; is the place where we can manage our Functions.&lt;/p&gt;

&lt;p&gt;Create a new function called &lt;code class=&quot;highlighter-rouge&quot;&gt;Record message&lt;/code&gt; and paste following code. Replace &lt;code class=&quot;highlighter-rouge&quot;&gt;YOUR_RUNTIME_DOMAIN&lt;/code&gt; with your Runtime Domain from &lt;a href=&quot;https://www.twilio.com/console/runtime/overview&quot;&gt;Runtime Overview&lt;/a&gt; page.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;twiml&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Twilio&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;twiml&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;VoiceResponse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// Use &amp;lt;Dial&amp;gt; to forward the call to my phone&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;dial&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;twiml&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;dial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;callerId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;+420999999999&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;dial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;number&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;+420111111111&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// Use &amp;lt;Say&amp;gt; to give the caller some instructions&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;twiml&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;say&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;We&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;re not available right now. Please leave a message after the beep.&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// Use &amp;lt;Record&amp;gt; to record the caller's message&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;twiml&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;record&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;https://YOUR_RUNTIME_DOMAIN/slack&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// End the call with &amp;lt;Hangup&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;twiml&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;hangup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// return the TwiML&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;twiml&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p class=&quot;post__image-center&quot;&gt;
  &lt;img src=&quot;/public/twilio-function.png&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;You probably noticed that &lt;code class=&quot;highlighter-rouge&quot;&gt;record&lt;/code&gt; command is pointing to &lt;code class=&quot;highlighter-rouge&quot;&gt;/slack&lt;/code&gt; URL. This will be another function. But before we can create it we need to add new npm package to our &lt;a href=&quot;https://www.twilio.com/console/runtime/functions/configure&quot;&gt;Runtime &amp;gt; Functions &amp;gt; Configure&lt;/a&gt;. The package is called &lt;a href=&quot;https://github.com/axios/axios&quot;&gt;axios&lt;/a&gt; and will help us with making HTTP request to Slack.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;
  &lt;img src=&quot;/public/twilio-function-config.png&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;There’s one more thing before we can get to the function and that is Slack Webhook URL. Luckily you can get one by visiting &lt;a href=&quot;https://slack.com/apps/A0F7XDUAZ-incoming-webhooks&quot;&gt;Slack App Directory&lt;/a&gt;. After that, we’ll have everything we need to create a Function.&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;axios&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;axios&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;axios&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;https://hooks.slack.com/services/TOKEN&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;`You have received a message from &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;${&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;From&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.\nTo listen to this message, please visit this URL:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;${&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;RecordingUrl&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.mp3`&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;OK&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;FAIL&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This Function takes the phone number of the caller and recording URL. Then POSTs a message to Slack. Now you’ll get a message when somebody leaves you a message.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Using Create React App 2 with Django 2</title>
   <link href="https://blog.rousek.name/2018/10/13/using-create-react-app-with-django/"/>
   <updated>2018-10-13T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2018/10/13/using-create-react-app-with-django</id>
   <content type="html">&lt;p&gt;I finally got opportunity to work on a project that used Django together with a React app. There’s a combination of packages that help with integrating CRA and Django.&lt;/p&gt;

&lt;h3 id=&quot;webpack-bundle-tracker--django-webpack-loader&quot;&gt;webpack-bundle-tracker + django-webpack-loader&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;django-webpack-loader&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;webpack-bundle-tracker&lt;/code&gt; work together in the following way. webpack-bundle-tracker plugin emits information about webpack’s compilation process and results so django-webpack-loader can consume it. To add &lt;code class=&quot;highlighter-rouge&quot;&gt;webpack-bundle-tracker&lt;/code&gt; to CRA we will need to hook up a plugin to webpack.&lt;/p&gt;

&lt;h3 id=&quot;cra-configuration&quot;&gt;CRA configuration&lt;/h3&gt;

&lt;p&gt;With your CRA app generated we start with &lt;code class=&quot;highlighter-rouge&quot;&gt;react-app-rewired&lt;/code&gt; configuration. Rewired uses &lt;code class=&quot;highlighter-rouge&quot;&gt;config-overrides.js&lt;/code&gt; file to hook into webpack configuration. There is one more change we have to make apart from adding &lt;code class=&quot;highlighter-rouge&quot;&gt;BundleTracker&lt;/code&gt;. The new &lt;a href=&quot;https://medium.com/webpack/webpack-4-code-splitting-chunk-graph-and-the-splitchunks-optimization-be739a861366&quot;&gt;splitChunks&lt;/a&gt; configuration is not entirely supported, so we have to use only named chunks.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BundleTracker&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;webpack-bundle-tracker&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;webpack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;nx&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;plugins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;BundleTracker&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;__dirname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;./build/webpack-stats.json&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}),&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;nx&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;optimization&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;splitChunks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;vendors&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After running &lt;code class=&quot;highlighter-rouge&quot;&gt;npm start&lt;/code&gt; we should see additional file &lt;code class=&quot;highlighter-rouge&quot;&gt;webpack-stats.json&lt;/code&gt; in build folder containing all the data we need.&lt;/p&gt;

&lt;h3 id=&quot;django-configuration&quot;&gt;Django configuration&lt;/h3&gt;

&lt;p&gt;Install &lt;code class=&quot;highlighter-rouge&quot;&gt;django-webpack-loader&lt;/code&gt; using &lt;a href=&quot;https://packaging.python.org/tutorials/managing-dependencies/&quot;&gt;pipenv&lt;/a&gt; or pip. Then go to your &lt;code class=&quot;highlighter-rouge&quot;&gt;settings.py&lt;/code&gt;. Add webpack_loader to INSTALLED_APPS. This will enable us to use template tags.&lt;/p&gt;

&lt;div class=&quot;language-py highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;INSTALLED_APPS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;'webpack_loader'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;project-structure&quot;&gt;Project structure&lt;/h4&gt;

&lt;p&gt;My project directory structure looks like this. I decided to put my CRA app to &lt;code class=&quot;highlighter-rouge&quot;&gt;frontend&lt;/code&gt; folder.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-tree&quot;&gt;├── Pipfile
├── Pipfile.lock
├── README.md
├── my_django_app
│   ├── __init__.py
│   ├── context_processors.py
│   ├── settings.py
│   ├── urls.py
│   ├── utils.py
│   └── wsgi.py
├── frontend
│   ├── build
│   ├── config-overrides.js
│   ├── node_modules
│   ├── package-lock.json
│   ├── package.json
│   ├── public
│   └── src
└── manage.py
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;With following structure, we can configure webpack loading in following way.&lt;/p&gt;

&lt;div class=&quot;language-py highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;STATICFILES_DIRS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# So Django knows about webpack files
&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BASE_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;frontend&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;build&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;static&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;WEBPACK_LOADER&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s&quot;&gt;&quot;DEFAULT&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;&quot;CACHE&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DEBUG&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;&quot;BUNDLE_DIR_NAME&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;frontend/build/static/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# must end with slash
&lt;/span&gt;        &lt;span class=&quot;s&quot;&gt;&quot;STATS_FILE&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BASE_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;frontend&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;build&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;webpack-stats.json&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;usage&quot;&gt;Usage&lt;/h3&gt;

&lt;p&gt;In our Django template we can then use &lt;code class=&quot;highlighter-rouge&quot;&gt;render_bundle&lt;/code&gt; to load our CRA app.&lt;/p&gt;

&lt;div class=&quot;language-liquid highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;render_bundle&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;from&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;webpack_loader&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;render_bundle&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'vendors'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;render_bundle&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'main'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;render_bundle&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'runtime~main'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It will also display the webpack error when the build process is failing.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;
  &lt;img src=&quot;/public/django-webpack-error.png&quot; alt=&quot;Webpack error in Django&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;I was very happy about getting Django and CRA to work together in this way and I can only recommend it.&lt;/p&gt;

&lt;h4 id=&quot;projects&quot;&gt;Projects&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/owais/django-webpack-loader&quot;&gt;django-webpack-loader&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/owais/webpack-bundle-tracker&quot;&gt;webpack-bundle-tracker&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Virtual support phone number with Twilio</title>
   <link href="https://blog.rousek.name/2018/09/09/virtual-business-phone-number-with-twilio/"/>
   <updated>2018-09-09T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2018/09/09/virtual-business-phone-number-with-twilio</id>
   <content type="html">&lt;p&gt;For a long time I was looking for a simple and, well, cheap solution to isolate my support phone number from my personal number and I’m going to share my solution with you.&lt;/p&gt;

&lt;p&gt;I like how Twilio makes things simple for developers so they were my first and only bet. What was I actually trying to achieve? I wanted to have a phone number that I could redirect to my phone and when the traffic gets high enough send caller to voicemail when needed. I also wanted to make a phone calls from that number using SIP phone.&lt;/p&gt;

&lt;p&gt;First, create a Twilio account and get voice-enabled phone number. Now we need to connect the dots. Let’s assume &lt;em&gt;+420111111111&lt;/em&gt; is your number and &lt;em&gt;+420999999999&lt;/em&gt; is the number you got from Twilio.&lt;/p&gt;

&lt;h3 id=&quot;receiving-calls&quot;&gt;Receiving calls&lt;/h3&gt;

&lt;p&gt;Twilio uses TwiML a markup language used to tell Twilio what to do when you receive an incoming call or SMS. The place where we will store our TwiML commands is called TwiML Bins. TwiML Bins allow you to write TwiML that Twilio will host for you - so we don’t have to spin up a web server.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.twilio.com/console/runtime/twiml-bins&quot;&gt;Runtime &amp;gt; TwiML Bins&lt;/a&gt; is the place where we can manage our Bins.&lt;/p&gt;

&lt;p&gt;Create a new bin called &lt;code class=&quot;highlighter-rouge&quot;&gt;Forward incoming calls to my phone&lt;/code&gt; and paste following code.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;Response&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;Dial&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;callerId=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;+420999999999&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    +420111111111
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Dial&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Response&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p class=&quot;post__image-center&quot;&gt;
  &lt;img src=&quot;/public/twilio-incoming-call-bin.png&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;Then we need to associate this bin with a phone number. In &lt;a href=&quot;https://www.twilio.com/console/phone-numbers/incoming&quot;&gt;Phone Numbers &amp;gt; Manage Numbers&lt;/a&gt; section select your phone number and look for a field called &lt;em&gt;A call comes in&lt;/em&gt;. Select &lt;em&gt;TwiML&lt;/em&gt; and the select the bin we just created.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;
  &lt;img src=&quot;/public/twilio-number-management.png&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;That’s it, you should now be able to accept incoming phone calls. Try calling your Twilio number.&lt;/p&gt;

&lt;h3 id=&quot;making-calls-using-your-twilio-number&quot;&gt;Making calls using your Twilio number&lt;/h3&gt;

&lt;p&gt;To make outgoing call using the Twilio number we will need to use VoIP application like &lt;a href=&quot;https://www.zoiper.com/en/products&quot;&gt;Zoiper&lt;/a&gt; which is available on Android and iOS. To use this application we need to set up a SIP domain. In &lt;a href=&quot;https://www.twilio.com/console/voice/sip/endpoints&quot;&gt;Programmable Voice &amp;gt; SIP Domains&lt;/a&gt; create a new domain.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;
  &lt;img src=&quot;/public/twilio-new-sip-domain.png&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;Make sure that you associate credentials for both &lt;em&gt;Voice Authentication&lt;/em&gt; and &lt;em&gt;SIP Registration&lt;/em&gt;. Then we create another TwiML Bin to handle outgoing calls.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;Response&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;Dial&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;callerId=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;+420999999999&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    {{#e164}}{{To}}{{/e164}}
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/Dial&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Response&amp;gt;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The interesting part of this command is &lt;code class=&quot;highlighter-rouge&quot;&gt;{{#e164}}{{To}}{{/e164}}&lt;/code&gt;. When using SIP Interface the &lt;code class=&quot;highlighter-rouge&quot;&gt;To&lt;/code&gt; value that gets passed down is in following form &lt;code class=&quot;highlighter-rouge&quot;&gt;sip:+15125551212@freelance.sip.us1.twilio.com&lt;/code&gt;. Function &lt;code class=&quot;highlighter-rouge&quot;&gt;e164&lt;/code&gt; extracts the phone number from this text. After saving this bin we will copy its &lt;em&gt;URL&lt;/em&gt; and use it as &lt;em&gt;Request URL&lt;/em&gt; in the SIP Domain we created.&lt;/p&gt;

&lt;h3 id=&quot;zoiper-configuration&quot;&gt;Zoiper configuration&lt;/h3&gt;

&lt;p&gt;Now that Twilio is setup we can actually make an outgoing call. We will use our SIP credentials we created before. You might have to fill in domain with the region &lt;code class=&quot;highlighter-rouge&quot;&gt;us1&lt;/code&gt; as domain without region or with any &lt;a href=&quot;https://www.twilio.com/docs/voice/api/sending-sip#localized-sip-uris&quot;&gt;other&lt;/a&gt; didn’t work for me.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;
  &lt;img src=&quot;/public/twilio-zoiper-configuration.jpeg&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;I’m pretty happy with the way how this solution works and the calls and number itself are pretty cheap.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Cool image loading with Gatsby.js v2 and Netlify CMS v2</title>
   <link href="https://blog.rousek.name/2018/08/10/cool-image-loading-with-gatsbyjs-v2-and-netlify-cms-v2/"/>
   <updated>2018-08-10T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2018/08/10/cool-image-loading-with-gatsbyjs-v2-and-netlify-cms-v2</id>
   <content type="html">&lt;p&gt;Time has come and even I got the opportunity to try out currently trending Gatsby.js static site generator. The most popular feature, at least from my point of view, is &lt;a href=&quot;https://image-processing.gatsbyjs.org/&quot;&gt;Image Processing with gatsby-transformer-sharp&lt;/a&gt;. I thought “Everyone talks that I can have out of the box responsive images and other cool things!”. Yeah sure, but they didn’t use it together with Netlify CMS while using beta of v2 :) Now with Gatsby v2 released things are a bit easier.&lt;/p&gt;

&lt;p&gt;Getting started with something as complex as Gatsby.js is always a challenge. Looking back I would compare Gatsby to Webpack. Complexity of plugin based processing pipeline makes it a bit harder to understand than good old static site generators.&lt;/p&gt;

&lt;p&gt;Now let’s investigate what do we actually need to make this work. Here are the plugins we need.&lt;/p&gt;

&lt;h3 id=&quot;gatsby-plugin-sharp&quot;&gt;gatsby-plugin-sharp&lt;/h3&gt;
&lt;p&gt;Exposes several image processing functions built on the Sharp.&lt;/p&gt;

&lt;h3 id=&quot;gatsby-transformer-sharp&quot;&gt;gatsby-transformer-sharp&lt;/h3&gt;
&lt;p&gt;Makes it possible to query &lt;a href=&quot;https://github.com/lovell/sharp&quot;&gt;Sharp image processing library&lt;/a&gt; processed images using GraphQL.&lt;/p&gt;

&lt;h3 id=&quot;gatsby-transformer-remark&quot;&gt;gatsby-transformer-remark&lt;/h3&gt;

&lt;p&gt;Uses &lt;a href=&quot;https://github.com/remarkjs/remark&quot;&gt;remark&lt;/a&gt; to parse the markdown files into usable data nodes for GraphQL.&lt;/p&gt;

&lt;h3 id=&quot;gatsby-remark-images&quot;&gt;gatsby-remark-images&lt;/h3&gt;
&lt;p&gt;This does the magic making images linked from markdown files responsive.&lt;/p&gt;

&lt;h3 id=&quot;gatsby-plugin-netlify-cms-paths&quot;&gt;gatsby-plugin-netlify-cms-paths&lt;/h3&gt;
&lt;p&gt;This is where the fun begins! Gatsby assumes that images are colocated with posts. This approach doesn’t work with Netlify CMS, because it stores images in a single place.&lt;/p&gt;

&lt;p&gt;I ended up with this configuration:&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;netlifyCmsPaths&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;`gatsby-plugin-netlify-cms-paths`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;cmsConfig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;`/static/admin/config.yml`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;netlifyCmsPaths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Including in your Gatsby plugins will transform any paths in your frontmatter&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;`gatsby-transformer-sharp`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;`gatsby-plugin-sharp`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;`gatsby-transformer-remark`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;plugins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;netlifyCmsPaths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Including in your Remark plugins will transform any paths in your markdown body&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;`gatsby-remark-images`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;c1&quot;&gt;// It's important to specify the maxWidth (in pixels) of&lt;/span&gt;
          &lt;span class=&quot;c1&quot;&gt;// the content container as this plugin uses this as the&lt;/span&gt;
          &lt;span class=&quot;c1&quot;&gt;// base for generating different widths of each image.&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;maxWidth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;930&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;backgroundColor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;transparent&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// required to display blurred image first&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;These are the versions that I’m using:&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nl&quot;&gt;&quot;gatsby-plugin-sharp&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;latest&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;gatsby-remark-images&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;latest&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;gatsby-transformer-remark&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;latest&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;gatsby-transformer-sharp&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;latest&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;gatsby-plugin-netlify-cms-paths&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;^1.0.2&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When Gatsby is configured this way I can embed image in markdown file like this &lt;code class=&quot;highlighter-rouge&quot;&gt;![Chemex](/img/chemex.jpg)&lt;/code&gt; and get this awesome loading “blur up” behavior.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;
    &lt;video width=&quot;600&quot; src=&quot;/public/gatsby-loading.mp4&quot; autoplay=&quot;&quot; loop=&quot;&quot;&gt;
    &lt;/video&gt;
&lt;/p&gt;

&lt;h2 id=&quot;working-with-images-stored-in-frontmatter&quot;&gt;Working with images stored in frontmatter&lt;/h2&gt;

&lt;p&gt;The blog I was working on has image displayed in the blog post list. The cover image was defined in frontmatter as follows.&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nn&quot;&gt;---&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;templateKey&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;blog-post&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;The ultimate Chemex guide&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;cover_image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;/img/chemex.jpg&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With all important bits in place let’s try running &lt;code class=&quot;highlighter-rouge&quot;&gt;gatsby develop&lt;/code&gt;, open http://localhost:8000/___graphql and run this query. You should see that image was processed.&lt;/p&gt;

&lt;div class=&quot;language-graphql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;allMarkdownRemark&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;edges&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frontmatter&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
          &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
          &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cover_image&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;childImageSharp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
              &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fluid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maxWidth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;700&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
              &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
          &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On &lt;code class=&quot;highlighter-rouge&quot;&gt;index.js&lt;/code&gt; page, I can then use this GraphQL query combined with &lt;a href=&quot;https://www.gatsbyjs.org/packages/gatsby-image/#gatsby-image&quot;&gt;gatsby-image&lt;/a&gt; package. This package provides wrapper around &lt;code class=&quot;highlighter-rouge&quot;&gt;img&lt;/code&gt; tag to generate HTML required to display responsive images. &lt;code class=&quot;highlighter-rouge&quot;&gt;GatsbyImageSharpFluid&lt;/code&gt; is a fragment provided by &lt;code class=&quot;highlighter-rouge&quot;&gt;gatsby-image&lt;/code&gt; its result we will then pass to &lt;code class=&quot;highlighter-rouge&quot;&gt;Img&lt;/code&gt; component.&lt;/p&gt;

&lt;div class=&quot;language-graphql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;cover_image&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;childImageSharp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fluid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maxWidth&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;630&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GatsbyImageSharpFluid&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Img&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;gatsby-image&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Img&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;fluid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;frontmatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cover_image&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;childImageSharp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;fluid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can see entire component and website on &lt;a href=&quot;https://github.com/Liduska/personal-blog/blob/master/src/pages/index.js#L45&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Overall I like Gatsby. I it’s one of the two static site generators I enjoy using. The other being &lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt;.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Visualizing Strava activites with Folium and Jupyter Notebook</title>
   <link href="https://blog.rousek.name/2018/08/05/visualizing-strava-activities-with-folium-and-jupyter-notebook/"/>
   <updated>2018-08-05T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2018/08/05/visualizing-strava-activities-with-folium-and-jupyter-notebook</id>
   <content type="html">&lt;p&gt;Few days ago I participated in my first race ever! It was short triathlon called &lt;a href=&quot;https://slapsky-triatlon.webnode.cz/&quot;&gt;Slapský triatlon&lt;/a&gt;. My friend was talking me into it for almost two years. The swimming is 500m, cycling is 34km and running is 4.5km. I don’t swim or run that much but I was pretty sure I can handle this. I was pretty confident with cycling which turned out to be a mistake. I was happy with the result overall. I wasn’t last. I’m pretty satisfied with swimming and running, but I could push a bit harder on the bike. The result is that I have some interesting data I can play around.&lt;/p&gt;

&lt;iframe src=&quot;/public/slapsky-triatlon.html&quot; style=&quot;width: 100%; height: 400px;border:none;&quot;&gt;&lt;/iframe&gt;
&lt;p style=&quot;text-align:center;color: #555;font-size:0.8rem;&quot;&gt;Speed visualization of the cycling part. Ranging from deep blue for slowest to deep red for fastest.&lt;/p&gt;

&lt;p&gt;When exploring the data I always use Jupyter Notebook and Folium. Folium lets you generate &lt;code class=&quot;highlighter-rouge&quot;&gt;leaflet.js&lt;/code&gt; maps directly from Python.&lt;/p&gt;

&lt;p&gt;Getting data from Strava is pretty simple. First, you need your Access Token. You can get them in &lt;a href=&quot;https://www.strava.com/settings/api&quot;&gt;My API Application&lt;/a&gt; section in Settings.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;stravalib.client&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Client&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;access_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;STRAVA_ACCESS_TOKEN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;types&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'time'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'distance'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'latlng'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'altitude'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'velocity_smooth'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'moving'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'grade_smooth'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;streams&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_activity_streams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ACTIVITY_ID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;types&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then to get stream data use &lt;code class=&quot;highlighter-rouge&quot;&gt;streams['altitude'].data&lt;/code&gt;. To make resulting map look a bit more smooth we need to group similar velocity data points. This does pretty good job.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;locations&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;streams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'latlng'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;velocities&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;streams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'velocity_smooth'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;locations&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;velocities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;groups&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;last_velocity&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;velocity&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;last_velocity&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last_velocity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;abs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;velocity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'velocity'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;velocity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'velocities'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'locations'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]})&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'locations'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'velocities'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;velocity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;last_velocity&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;velocity&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;statistics&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'velocity'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;statistics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;median_high&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'velocities'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To correctly colorize segments we need to normalize and map the values to colors. Luckily &lt;code class=&quot;highlighter-rouge&quot;&gt;matplotlib&lt;/code&gt; does this for us with the exception of converting the color to hex. First, we will use &lt;code class=&quot;highlighter-rouge&quot;&gt;Normalize&lt;/code&gt; to, well, normalize the value and then &lt;a href=&quot;https://matplotlib.org/tutorials/colors/colormaps.html&quot;&gt;colormap&lt;/a&gt; value to color. The last step is converting rgb 0.0 - 1.0 to hex.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;convert_to_hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rgba_color&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;red&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rgba_color&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;capitalize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;green&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rgba_color&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;capitalize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;blue&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rgba_color&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;capitalize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'0'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;blue&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'00'&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;red&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'0'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;red&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'00'&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;green&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'0'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;green&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'00'&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'#'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;red&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;green&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blue&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.cm&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.colors&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Normalize&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bwr&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Normalize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vmin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;velocities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vmax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;velocities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;colorize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grade&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;convert_to_hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grade&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With grouped data and correct color the only thing we need to do is generate &lt;code class=&quot;highlighter-rouge&quot;&gt;PolyLine&lt;/code&gt;s for each group and display map.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;folium&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;folium&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;49.7947117&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;14.3916288&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tiles&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Stamen Toner'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zoom_start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;12.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;folium&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PolyLine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'locations'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colorize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;group&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'velocity'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can see the entire notebook on &lt;a href=&quot;https://nbviewer.jupyter.org/github/stlk/strava-playground/blob/master/Strava%20route%20visualizer.ipynb&quot;&gt;nbviewer.jupyter.org&lt;/a&gt;. Here are my &lt;a href=&quot;https://www.strava.com/activities/1732801109&quot;&gt;ride&lt;/a&gt; and &lt;a href=&quot;https://www.strava.com/activities/1732871895&quot;&gt;run&lt;/a&gt; if you want to explore my activities on Strava.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Stuff I wish I knew when starting with Flow</title>
   <link href="https://blog.rousek.name/2018/07/19/stuff-i-wish-knew-when-starting-with-flow/"/>
   <updated>2018-07-19T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2018/07/19/stuff-i-wish-knew-when-starting-with-flow</id>
   <content type="html">&lt;p&gt;Typing in dynamic languages is hard. Especially in small projects where interaction with libraries is hiding on every corner.
I tried to get into Flow at least two times before. Now I finally think I got far enough to experience enough of important obstacles that suffice to write about them.&lt;/p&gt;

&lt;h2 id=&quot;what-editor-should-i-use&quot;&gt;What editor should I use&lt;/h2&gt;

&lt;p&gt;Technically, both Atom and VS Code should work with Flow. However, VS Code wasn’t working well for me. On the other hand &lt;a href=&quot;https://github.com/flowtype/ide-flowtype&quot;&gt;Flow for Atom IDE&lt;/a&gt; works great.&lt;/p&gt;

&lt;h2 id=&quot;where-to-start&quot;&gt;Where to start&lt;/h2&gt;

&lt;p&gt;With Flow you can pick the file you want to start with. Flow will treat imported untyped files as type &lt;code class=&quot;highlighter-rouge&quot;&gt;any&lt;/code&gt;.
I started with a React component which accepts simple object just to get my feet wet and get familiar with the syntax. After this exploration phase it’s good to try getting business logic typed.&lt;/p&gt;

&lt;h2 id=&quot;interacting-with-html-elements&quot;&gt;Interacting with HTML elements&lt;/h2&gt;

&lt;p&gt;Finding the correct way to handle type casting of HTML elements took me surprisingly a lot of the time. But the solution turned out to be pretty simple. Flow looks for &lt;code class=&quot;highlighter-rouge&quot;&gt;instanceof&lt;/code&gt; conditions and for following code it works with correct type. Useful tool for asserting HTML elements is &lt;code class=&quot;highlighter-rouge&quot;&gt;invariant&lt;/code&gt;. It takes condition and error message and raises the error message when the condition isn’t met.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;form&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;formId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;invariant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;form&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;form&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;HTMLFormElement&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;Could not find a form.&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;arrays---type-syntax-can-actually-differ&quot;&gt;Arrays - type syntax can actually differ&lt;/h2&gt;

&lt;p&gt;When specifying a type for an array I automatically typed &lt;code class=&quot;highlighter-rouge&quot;&gt;[Item]&lt;/code&gt;. This is valid syntax in Flow, but it means something which you won’t need most of the time. It means array with one item of type &lt;code class=&quot;highlighter-rouge&quot;&gt;Item&lt;/code&gt;. You are most likely looking for &lt;code class=&quot;highlighter-rouge&quot;&gt;Item[]&lt;/code&gt;. This took me quite some time to realize.&lt;/p&gt;

&lt;h2 id=&quot;higher-order-components&quot;&gt;Higher-Order Components&lt;/h2&gt;

&lt;p&gt;HOCs are sometimes tough to type correctly because it’s so easy to mix in &lt;code class=&quot;highlighter-rouge&quot;&gt;any&lt;/code&gt; type and lose the type checking. Let’s try typing this &lt;code class=&quot;highlighter-rouge&quot;&gt;withLoader&lt;/code&gt; HOC. I confess that I haven’t figured out how to write fully generic HOC.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;withLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;LoaderComponent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;innerComponent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;WrappedComponent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;props&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;props&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loading&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;LoaderComponent&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;props&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;WrappedComponent&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;props&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;innerComponent&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It’s just a condition wrapped in two functions, which shouldn’t be that hard. First call supplies loader component and second call supplies the component we are wrapping.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;WrappedComponentWithLoader&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;withLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;LoaderComponent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;WrappedComponent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looking at &lt;a href=&quot;https://flow.org/en/docs/react/types/#toc-react-componenttype&quot;&gt;Flow docs&lt;/a&gt; I found that React uses two types to define component types. I will use &lt;code class=&quot;highlighter-rouge&quot;&gt;React.StatelessFunctionalComponent&lt;/code&gt; to keep things “simple”.&lt;/p&gt;

&lt;div class=&quot;language-jsx highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;withLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;LoaderComponent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;React&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;StatelessFunctionalComponent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;innerComponent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Props&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;loading&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;WrappedComponent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;React&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;StatelessFunctionalComponent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Props&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;React&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;StatelessFunctionalComponent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Props&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;props&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;props&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loading&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;LoaderComponent&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;WrappedComponent&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;props&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;innerComponent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After adding types this HOC looks pretty intimidating. I will try to walk you through without scaring you off.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;LoaderComponent: React.StatelessFunctionalComponent&amp;lt;any&amp;gt;&lt;/code&gt; means that function &lt;code class=&quot;highlighter-rouge&quot;&gt;withLoader&lt;/code&gt; accepts any stateless component. Then there is my generic wrapped component. &lt;code class=&quot;highlighter-rouge&quot;&gt;innerComponent&amp;lt;Props: { loading: boolean }&amp;gt;&lt;/code&gt; part defines that function has generic type which is required to be object with &lt;code class=&quot;highlighter-rouge&quot;&gt;loading&lt;/code&gt; field of type &lt;code class=&quot;highlighter-rouge&quot;&gt;boolean&lt;/code&gt;. I used this type to define &lt;code class=&quot;highlighter-rouge&quot;&gt;Props&lt;/code&gt; of my wrapped component. This is the only solution I found that passes up the types defined in decorated component so the type restrictions are correctly propagated and property &lt;code class=&quot;highlighter-rouge&quot;&gt;loading&lt;/code&gt; is also required. The last line that is related to flow is &lt;code class=&quot;highlighter-rouge&quot;&gt;): React.StatelessFunctionalComponent&amp;lt;Props&amp;gt; {&lt;/code&gt; which actually defines that new component will have type discussed previously.&lt;/p&gt;

&lt;p&gt;You can play with this component on &lt;a href=&quot;https://flow.org/try/#0PTAEAEDMBsHsHdQGcAuAnAlgYxQWjlgIbQBQGAtgA6xoqgBUohSoASgKaE6iRqzmgARGk45BAbhIlIAVwB2ODLDmh4GFAAsAMrEIATdmgAUO-YYDC-anPZyUALjaiUAOgDKKQinbR2SJABi8orKxJZUyrYoADyEcgCeAHwAlKAA3iSgPMEoSioYcjZo4dZR0QAKfJRIjmmgcPoFAOaOAEawsL5xoAC+iUaZWaAA6miElJTseiWRdo4cXK4eXj5+gTl5YVazMZWw1YmDyfPO7p7evv5BCrmh0DM2dhVVSInpg1kiKDJoKpQvoAAvIchkN-vskC4GnpmkDAYDQOgZOxQAB+UADUGg6KmAzFbaPOjAEFY1KOTFYrLRUbjSbTAlRdIuZng6o9UDEj5DZKSLI9QZfH75QoWBl2ST8khYZSoUC4wxAjGpYGgaIwgBuiWhzWZLmiwA1iUkUpldAAsvEHoyEUY6t4AB50Hq1RHsR2OVCYORNXrKt4ZT7sb6-VWGtIOlA9fWGiVSaVyWUAES8hEVak08uMmeSRgtVrsPLjptAAEEJoqjH6MYM1RhNVzosnPPVdDDvYDw2hkeyI4DBJoMCxB6AsGMAF7xACEgg5JKpTdT2vbne7s4bC9djr7A6HLFHhAn07XVINdcOhZIbuotFABkghBk0DoZco4iAAa&quot;&gt;Try Flow&lt;/a&gt; and see that Flow warns us about missing props.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Local state management pomocí Apollo</title>
   <link href="https://blog.rousek.name/2018/06/08/local-state-management-pomoci-apollo/"/>
   <updated>2018-06-08T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2018/06/08/local-state-management-pomoci-apollo</id>
   <content type="html">&lt;p&gt;Apollo je sada nástrojů pro práci s GraphQL od tvůrců Meteor.js. Apollo Client slouží k napojení UI na data, Apollo Engine na infrastrukturu a tooling a nakonec Apollo Server pro zpřístupnění REST API pomocí GraphQL.&lt;/p&gt;

&lt;p&gt;V tomto článku bych se rád zaměřil na velmi užitečnou část zvanou &lt;a href=&quot;https://github.com/apollographql/apollo-link-state&quot;&gt;apollo-link-state&lt;/a&gt;. Když používám &lt;a href=&quot;https://www.apollographql.com/docs/react/essentials/get-started.html#apollo-boost&quot;&gt;Apollo Client&lt;/a&gt;, tak mám vyřešenou práci s API. V aplikaci je ale vždy nějaký lokální stav, s jehož správou mi Apollo Client může pomoci.&lt;/p&gt;

&lt;p&gt;Běžně se pro uchování lokálního stavu používá Redux nebo MobX. S pomocí &lt;code class=&quot;highlighter-rouge&quot;&gt;apollo-link-state&lt;/code&gt; je nově možné použít cache Apollo Clienta jako úložiště pro všechna naše data. Pro čtení nebo zápis lokálního stavu použijeme queries a mutations jako bychom pracovali s daty na serveru.&lt;/p&gt;

&lt;p&gt;Začít ukládat stav pomocí &lt;code class=&quot;highlighter-rouge&quot;&gt;apollo-link-state&lt;/code&gt; je velmi jednoduché. Jako základ používám &lt;a href=&quot;https://www.apollographql.com/docs/react/essentials/get-started.html#apollo-boost&quot;&gt;apollo-boost&lt;/a&gt;. &lt;code class=&quot;highlighter-rouge&quot;&gt;apollo-boost&lt;/code&gt; je balíček apollo knihoven, který zahrnuje i &lt;code class=&quot;highlighter-rouge&quot;&gt;apollo-link-state&lt;/code&gt;. Při inicializaci klienta nastavím &lt;code class=&quot;highlighter-rouge&quot;&gt;clientState&lt;/code&gt; a vyplním výchozí hodnoty.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-jsx&quot; data-lang=&quot;jsx&quot;&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ApolloClient&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;apollo-boost&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ApolloClient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;clientState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;defaults&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;expanded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;resolvers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;clientState&lt;/code&gt; přijímá i parametr &lt;code class=&quot;highlighter-rouge&quot;&gt;typeDefs&lt;/code&gt;. Toto schéma se nepoužívá pro validaci jako na serveru, protože knihovna &lt;code class=&quot;highlighter-rouge&quot;&gt;graphql-js&lt;/code&gt; by výrazně zvedla velikost výsledného balíku. Client-side schéma se používá v Apollo DevTools, kde je možné schéma prozkoumat.&lt;/p&gt;

&lt;p&gt;Pro čtení dat pak stačí použít GraphQL query s direktivou &lt;code class=&quot;highlighter-rouge&quot;&gt;@client&lt;/code&gt;. Na stejném principu fungují ostatní Apollo Link knihovny, např. &lt;code class=&quot;highlighter-rouge&quot;&gt;apollo-link-rest&lt;/code&gt;. Ta používá &lt;code class=&quot;highlighter-rouge&quot;&gt;@rest&lt;/code&gt; direktivu pro označení polí, která by měla být načtena z REST endpointu. Direktivy &lt;code class=&quot;highlighter-rouge&quot;&gt;@client&lt;/code&gt; a &lt;code class=&quot;highlighter-rouge&quot;&gt;@rest&lt;/code&gt; nemění podobu dat, jen určují odkud se data načítají.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-jsx&quot; data-lang=&quot;jsx&quot;&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Query&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;react-apollo&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gql&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;apollo-boost&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;SECTION_QUERY&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gql&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;`
  {
    expanded @client
  }
`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Expander&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Query&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;query=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;SECTION_QUERY&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;expanded&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;expanded&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;collapsed&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Zbýva vyřešit zápis dat. Zde jsou na výběr dvě možnosti. První je zápis přímo do cache použitím &lt;code class=&quot;highlighter-rouge&quot;&gt;client.writeData&lt;/code&gt; v komponentách &lt;code class=&quot;highlighter-rouge&quot;&gt;ApolloConsumer&lt;/code&gt;, nebo &lt;code class=&quot;highlighter-rouge&quot;&gt;Query&lt;/code&gt;. Přímý zápis je vhodný pro jednorázové zápisy nezávislé na datech uložených v cache. Druhá možnost je Mutation, volající client-side resolver. Resolver může pracovat s daty v cache, hodí se tedy např. na přidávání položek do seznamu nebo přepínání hodnoty. Přímý zápis bych přirovnal k &lt;code class=&quot;highlighter-rouge&quot;&gt;setState&lt;/code&gt;, zatímco resolver připomíná Redux.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-jsx&quot; data-lang=&quot;jsx&quot;&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ApolloConsumer&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;react-apollo&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;expand&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;writeData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;expanded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ApolloConsumer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;button&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;onClick=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;expand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;See FAQs&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;button&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ApolloConsumer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Pokud bych potřeboval použít mutation, musím nejdříve do &lt;code class=&quot;highlighter-rouge&quot;&gt;ApolloClient&lt;/code&gt; přidat &lt;a href=&quot;https://www.apollographql.com/docs/react/essentials/local-state.html#resolvers&quot;&gt;resolver&lt;/a&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-jsx&quot; data-lang=&quot;jsx&quot;&gt;&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;ApolloClient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;clientState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;defaults&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;expanded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;resolvers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;Mutation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;expand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;cache&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;cache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;writeData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;expanded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Potom přidám komponentu &lt;code class=&quot;highlighter-rouge&quot;&gt;Mutation&lt;/code&gt; a předám jí mutation s direktivou &lt;code class=&quot;highlighter-rouge&quot;&gt;@client&lt;/code&gt;. To řekne &lt;code class=&quot;highlighter-rouge&quot;&gt;apollo-link-state&lt;/code&gt;, aby volal lokální &lt;code class=&quot;highlighter-rouge&quot;&gt;expand&lt;/code&gt; mutation resolver pro zpracování mutation.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-jsx&quot; data-lang=&quot;jsx&quot;&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Mutation&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;react-apollo&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;FAQ_SECTION_EXPAND&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gql&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;`
  mutation expand {
    expand @client
  }
`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Mutation&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;mutation=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;FAQ_SECTION_EXPAND&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;expand&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Button&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;onClick=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;expand&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;See FAQs&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Button&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Mutation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Toto bylo moje základní seznámení s &lt;code class=&quot;highlighter-rouge&quot;&gt;apollo-link-state&lt;/code&gt;. V jednom z budoucích článků popíšu jak na kombinování lokálního stavu se stavem ze serveru a složitější mutations. Aplikaci používající &lt;a href=&quot;https://codesandbox.io/s/2jvjvllr9y&quot;&gt;přímý zápis&lt;/a&gt; i &lt;a href=&quot;https://codesandbox.io/s/l4mkk62k39&quot;&gt;mutations&lt;/a&gt; najdete na CodeSandbox.&lt;/p&gt;

&lt;h3 id=&quot;školení-graphql-a-apollo&quot;&gt;Školení GraphQL a Apollo&lt;/h3&gt;

&lt;p&gt;Vedu &lt;a href=&quot;https://rousek.name/skoleni/#graphql-a-apollo&quot;&gt;GraphQL a Apollo workshop&lt;/a&gt;, kde si vyzkoušíme Apollo Client v praxi.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Jak umožnit doručení pomocí Zásilkovna.cz na Shopify</title>
   <link href="https://blog.rousek.name/2018/06/02/jak-umoznit-doruceni-pomoci-zasilkovna-cz-na-shopify/"/>
   <updated>2018-06-02T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2018/06/02/jak-umoznit-doruceni-pomoci-zasilkovna-cz-na-shopify</id>
   <content type="html">&lt;p&gt;Klient mě oslovil se záměrem poskytovat doručování pomocí Zásilkovna.cz na Shopify. Vzhledem k omezeným možnostem ovlivnit checkout proces u levnějších Shopify variant se to ukázalo jako cvičení tvořivosti.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Úpravu checkout procesu umožňuje pouze enterprise varianta &lt;a href=&quot;https://www.shopify.com/plus&quot;&gt;Shopify Plus&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Jak je vlastně možné ovlivnit checkout proces na Shopify? Poslední místo, kde je možné zasahovat do HTML je v košíku. V checkout procesu je možné měnit pouze texty. Dalším pomocníkem je &lt;a href=&quot;https://help.shopify.com/api/reference/shipping_and_fulfillment/carrierservice&quot;&gt;CarrierService&lt;/a&gt;. Ta umožňuje ovlivnit nabídku způsobu doručení na základě obsahu košíku.&lt;/p&gt;

&lt;p&gt;Ustálené řešení jak nabídnout výběr z velkého množství výdejních míst je následující.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;V košíku umožnit výběr výdejního místa.&lt;/li&gt;
  &lt;li&gt;Doručovací adresu použít jako adresu vyzvednutí.&lt;/li&gt;
  &lt;li&gt;Pokud bylo vybráno výdejní místo, v seznamu způsobů doručení se zobrazí pouze Zásilkovna v opačném případě bežné způsoby doručení.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Ukázku checkout procesu s výběrem výdejního místa můžete vidět na následujícím videu.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;
  &lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube-nocookie.com/embed/w4am7vFEKSs?rel=0&quot; frameborder=&quot;0&quot; allow=&quot;autoplay; encrypted-media&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;
&lt;/p&gt;

&lt;p&gt;Chcete také nabízet doručení na výdejní místa Zásilkovna.cz na svém e-shopu? Nebo chcete přesně vědět jako to funguje? Neváhejte mě kontaktovat.&lt;/p&gt;

&lt;h3 id=&quot;zajímá-vás-shopify&quot;&gt;Zajímá vás Shopify?&lt;/h3&gt;

&lt;p&gt;Přihlašte se a budete dostávat tipy a novinky související s provozováním e-shopu na Shopify.&lt;/p&gt;

&lt;form action=&quot;https://www.getdrip.com/forms/572224451/submissions&quot; method=&quot;post&quot; data-drip-embedded-form=&quot;572224451&quot;&gt;
  &lt;div&gt;
      &lt;label for=&quot;drip-email&quot;&gt;E-mail&lt;/label&gt;&lt;br /&gt;
      &lt;input type=&quot;email&quot; id=&quot;drip-email&quot; name=&quot;fields[email]&quot; value=&quot;&quot; /&gt;
  &lt;/div&gt;
  &lt;input type=&quot;submit&quot; value=&quot;Přihlásit k odběru&quot; data-drip-attribute=&quot;sign-up-button&quot; /&gt;
&lt;/form&gt;
</content>
 </entry>
 
 <entry>
   <title>Shopify - Fakturoid: Variabilní symbol z externího systému</title>
   <link href="https://blog.rousek.name/2018/05/22/variabilni-symbol-z-externiho-systemu/"/>
   <updated>2018-05-22T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2018/05/22/variabilni-symbol-z-externiho-systemu</id>
   <content type="html">&lt;blockquote&gt;
  &lt;p&gt;Tento článek se vztahuje k integraci propojující &lt;a href=&quot;https://apps.shopify.com/fakturoid-invoices&quot;&gt;Shopify a Fakturoid.cz&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Máte systém na zpracování objednávek generující vlastní čísla objednávek a potřebujete použít toto číslo jako variabilní symbol? Nově je možné použít atributy uložené v &lt;code class=&quot;highlighter-rouge&quot;&gt;note_attributes&lt;/code&gt; jako variabilní symbol na faktuře. Tento atribut má několik názvů v závislosti na místě použití.&lt;/p&gt;

&lt;p&gt;Celý proces začíná v nákupním košíku, kde je možné pomocí skrytého &lt;code class=&quot;highlighter-rouge&quot;&gt;input&lt;/code&gt; elementu nastavit &lt;a href=&quot;https://help.shopify.com/themes/customization/cart/get-more-information-with-cart-attributes#sectioned-themes&quot;&gt;Cart attribute&lt;/a&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;hidden&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;attributes[shopify_fakturoid_variable_symbol]&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;{{ cart.attributes[&quot;&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;shopify_fakturoid_variable_symbol&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&quot;]&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;}}&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Pro složitější aplikace je také možné použít &lt;a href=&quot;https://help.shopify.com/themes/development/getting-started/using-ajax-api#update-cart&quot;&gt;Shopify Ajax API&lt;/a&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;nx&quot;&gt;jQuery&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/cart/update.js&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;attributes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;shopify_fakturoid_variable_symbol&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;123456789&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Tento atribut se zobrazí v sekci &lt;strong&gt;Additional details&lt;/strong&gt; v detailu objednávky v administraci Shopify.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;
  &lt;img src=&quot;/public/variable-symbol-aditional-details.png&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;Posledním krokem je zobrazení instrukcí k platbě. K tomuto účelu je možné využít notifikační e-mail &lt;em&gt;Order confirmation&lt;/em&gt;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Návod předpokládá, že máte v sekci &lt;em&gt;Settings &amp;gt; Payments &amp;gt; Manual payments&lt;/em&gt; zapnutou platbu s názvem &lt;em&gt;Bank Deposit&lt;/em&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;/public/order-confirmation.png&quot; target=&quot;_blank&quot;&gt;
  &lt;img src=&quot;/public/order-confirmation.png&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;V šabloně najděte sekci &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;h4&amp;gt;Payment method&amp;lt;/h4&amp;gt;&lt;/code&gt;, konkrétně &lt;code class=&quot;highlighter-rouge&quot;&gt;{{ transaction.gateway | replace: &quot;_&quot;, &quot; &quot;...&lt;/code&gt;. Za &lt;code class=&quot;highlighter-rouge&quot;&gt;{% endif %}&lt;/code&gt; po tomto výrazu vložte kód uvozený &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;!-- Platební informace --&amp;gt;&lt;/code&gt; a &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;!-- / Platební informace --&amp;gt;&lt;/code&gt; dle příkladu.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-liquid&quot; data-lang=&quot;liquid&quot;&gt;&amp;lt;!-- Platební informace --&amp;gt;
&lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;transaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;gateway&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Bank Deposit&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
&amp;lt;p class=&quot;customer-info__item-content&quot;&amp;gt;
    &amp;lt;strong&amp;gt;Číslo účtu:&amp;lt;/strong&amp;gt; 123457/0000
&amp;lt;/p&amp;gt;
&amp;lt;p class=&quot;customer-info__item-content&quot;&amp;gt;
    &amp;lt;strong&amp;gt;Variabilní symbol:&amp;lt;/strong&amp;gt;
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;order&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;attributes&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;attribute&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;order.attributes&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;attribute&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;first&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;shopify_fakturoid_variable_symbol&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;attribute&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;last&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;endfor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
&amp;lt;/p&amp;gt;
&lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
&amp;lt;!-- / Platební informace --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;nastavení-aplikace&quot;&gt;Nastavení aplikace&lt;/h3&gt;

&lt;p&gt;Pro aktivaci této funkce stačí nastavit název atributu v sekci &lt;strong&gt;Custom Variable symbol&lt;/strong&gt;.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;
  &lt;img src=&quot;/public/variable-symbol-settings.png&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;Více o automatizaci platby převodem se dozvíte v článku &lt;a href=&quot;/2017/07/03/automatizace-platby-prevodem-na-shopify/&quot;&gt;Automatizace platby převodem na Shopify pomocí Fakturoidu&lt;/a&gt;.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>Statically generated e-commerce using Shopify and Netlify</title>
   <link href="https://blog.rousek.name/2018/04/12/statically-generated-ecommerce-using-shopify-and-netlify/"/>
   <updated>2018-04-12T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2018/04/12/statically-generated-ecommerce-using-shopify-and-netlify</id>
   <content type="html">&lt;p&gt;I recently fell in love with Netlify because of its simplicity and speed. Nelify allows you to build and host your website in one place with generous pricing levels. I wanted to explore what are possibilities when it comes to e-commerce so I decided to create a simple statically generated website where I could sell some products.&lt;/p&gt;

&lt;p&gt;As a Shopify fan, I will try to use Shopify to manage my products and orders. Shopify offers a pricing plan called &lt;a href=&quot;https://www.shopify.com/lite&quot;&gt;Shopify Lite&lt;/a&gt; for $9 per month. Most notable features of this plan are Buy Button and Facebook Messenger sales channels.&lt;/p&gt;

&lt;p&gt;I will use their GraphQL API to retrieve the products. With data from Shopify, I will generate static website containing product list and &lt;a href=&quot;https://github.com/Shopify/buy-button-js&quot;&gt;BuyButton.js&lt;/a&gt; code. Let’s see how it fits together.&lt;/p&gt;

&lt;h2 id=&quot;setting-up&quot;&gt;Setting up&lt;/h2&gt;

&lt;p&gt;Let’s start by creating Store in Shopify. Then add new sales channel called Buy Button. Now you need to find API token so you can use the API. To get there select a product and then click &lt;em&gt;Generate code&lt;/em&gt;. In the generated script find and copy &lt;code class=&quot;highlighter-rouge&quot;&gt;domain&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;apiKey&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/public/shopify_buy_button_code.png&quot; target=&quot;_blank&quot;&gt;
  &lt;img src=&quot;/public/shopify_buy_button_code.png&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;With the credentials from the script, we can focus on Netlify. First fork my project from &lt;a href=&quot;https://github.com/stlk/shopify-buy-button&quot;&gt;github.com/stlk/shopify-buy-button&lt;/a&gt; so you can add it to your Netlify account. In the Netlify &lt;em&gt;site Settings&lt;/em&gt; go to &lt;em&gt;Build &amp;amp; deploy&lt;/em&gt; and the to &lt;em&gt;Build environment variables&lt;/em&gt; section. While in there fill in &lt;code class=&quot;highlighter-rouge&quot;&gt;SHOPIFY_SHOP_DOMAIN&lt;/code&gt; (only the part before &lt;code class=&quot;highlighter-rouge&quot;&gt;.myshopify.com&lt;/code&gt;) and &lt;code class=&quot;highlighter-rouge&quot;&gt;SHOPIFY_STOREFRONT_TOKEN&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/public/netlify_env_variables.png&quot; target=&quot;_blank&quot;&gt;
  &lt;img src=&quot;/public/netlify_env_variables.png&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can now check Deploys section to see if the build succeeded. If not, try rebuilding using &lt;em&gt;Trigger deploy&lt;/em&gt;. After the build is published you can visit your e-shop!&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;
  &lt;img src=&quot;/public/checkout.gif&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/p&gt;

&lt;p&gt;But do not rejoice! You still have one last step to make Netlify rebuild the site after you change or create the product in Shopify.&lt;/p&gt;

&lt;p&gt;This is just the right job for webhooks. In our favourite section &lt;em&gt;Build &amp;amp; deploy&lt;/em&gt; in Netlify’s Settings create a new &lt;em&gt;Build hook&lt;/em&gt;. Keep the branch setting on master. This creates a unique URL that will cause your site to rebuild when POST request hits. We will use this URL in Shopify.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/public/netlify_webhooks.png&quot; target=&quot;_blank&quot;&gt;
  &lt;img src=&quot;/public/netlify_webhooks.png&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In your Shopify Store administration go to &lt;em&gt;Settings&lt;/em&gt; &amp;gt; &lt;em&gt;Notifications&lt;/em&gt; and scroll down to &lt;em&gt;Webhooks&lt;/em&gt;. In there create three webhooks for &lt;code class=&quot;highlighter-rouge&quot;&gt;Product creation&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;Product update&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;Product deletion&lt;/code&gt; point all three to the &lt;em&gt;Build hook&lt;/em&gt; we just created. Don’t the format setting as we aren’t reading any data from it.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/public/shopify_webhooks.png&quot; target=&quot;_blank&quot;&gt;
  &lt;img src=&quot;/public/shopify_webhooks.png&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Hope this helped you explore unusual take on building e-commerce site. If you want to find out more about internals, keep reading.&lt;/p&gt;

&lt;h2 id=&quot;how-did-we-get-the-data-from-shopify&quot;&gt;How did we get the data from Shopify&lt;/h2&gt;

&lt;p&gt;The script uses &lt;a href=&quot;https://help.shopify.com/api/storefront-api/getting-started#accessing-the-storefront-api-graphql-endpoint&quot;&gt;Storefront API GraphQL&lt;/a&gt; which lets us to specify exactly what data we need. You can play around with data from example shop using &lt;a href=&quot;https://help.shopify.com/api/storefront-api/graphql-explorer/graphiql&quot;&gt;GraphiQL&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{
  shop {
    name
    products(first: 10) {
      edges {
        node {
          id
          title
          descriptionHtml
          images(first: 1) {
            edges {
              node {
                originalSrc
              }
            }
          }
        }
      }
    }
  }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can see it in action in &lt;code class=&quot;highlighter-rouge&quot;&gt;build.py&lt;/code&gt; on &lt;a href=&quot;https://github.com/stlk/shopify-buy-button/blob/master/build.py#L25&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Export Rails model data as CSV</title>
   <link href="https://blog.rousek.name/2018/03/01/export-rails-model-data-as-csv/"/>
   <updated>2018-03-01T00:00:00-06:00</updated>
   <id>https://blog.rousek.name/2018/03/01/export-rails-model-data-as-csv</id>
   <content type="html">&lt;p&gt;I needed to allow my customer to export a bunch of tables. After some digging, I found a pretty neat solution.&lt;/p&gt;

&lt;p&gt;Let’s say we have a &lt;code class=&quot;highlighter-rouge&quot;&gt;Customer&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;Order&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;OrderItem&lt;/code&gt; model. We want to allow the user to download exported data as CSV in a single zip file. To generate CSV from the model we can use following code.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Customer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ApplicationRecord&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_csv&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;attributes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sx&quot;&gt;%w{id name email address}&lt;/span&gt;

    &lt;span class=&quot;no&quot;&gt;CSV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;generate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;headers: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attributes&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;treatment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attributes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;treatment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;attr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Then we need only to package up the files in &lt;code class=&quot;highlighter-rouge&quot;&gt;zip&lt;/code&gt; file and send it to the user.&lt;/p&gt;

&lt;p&gt;We will use a gem called &lt;code class=&quot;highlighter-rouge&quot;&gt;rubyzip&lt;/code&gt;. To instal it add this to your &lt;code class=&quot;highlighter-rouge&quot;&gt;Gemfile&lt;/code&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;gem&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'rubyzip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;require: &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'zip'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;We can write text files directly to an archived file using &lt;code class=&quot;highlighter-rouge&quot;&gt;puts&lt;/code&gt;, so all we need to do is to use &lt;code class=&quot;highlighter-rouge&quot;&gt;Tempfile&lt;/code&gt; as our backing file.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Admin&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ExportsController&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Admin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;ApplicationController&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;download_export&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;tables&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;no&quot;&gt;Customer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;no&quot;&gt;Order&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;no&quot;&gt;OrderItem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;shop-export-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;today&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.zip&quot;&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;temp_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Tempfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Zip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;OutputStream&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;tables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;zos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;put_next_entry&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;downcase&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.csv&quot;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;zos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;to_csv&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;zip_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;send_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zip_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;type: &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'application/zip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;filename: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;ensure&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;temp_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;close&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;temp_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;unlink&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</content>
 </entry>
 
 <entry>
   <title>Toggl reports to Slack for free plan</title>
   <link href="https://blog.rousek.name/2017/12/28/toggl-reports-to-slack-for-free-plan/"/>
   <updated>2017-12-28T00:00:00-06:00</updated>
   <id>https://blog.rousek.name/2017/12/28/toggl-reports-to-slack-for-free-plan</id>
   <content type="html">&lt;p&gt;I wanted to expose a bit of insight to my team. As we work in kind of upredictable manner we could use a report on who worked a day before. We use Trello as our time tracking tool. It supports weekly email reports but the price for this feature was a bit expensive for us. So I did a quick research and found &lt;a href=&quot;https://github.com/jsmartin/toggl_report&quot;&gt;Trello report script&lt;/a&gt; that does exactly what I wanted. It outputs &lt;a href=&quot;https://github.com/jsmartin/toggl_report/blob/master/sample.md&quot;&gt;markdown&lt;/a&gt; to STDOUT.&lt;/p&gt;

&lt;p&gt;I’ve modified the script to include time spent for each entry and updated it to Python 3.&lt;/p&gt;

&lt;p&gt;With the reporting part done I started to investigate how to post the report to Slack. I found three possible ways I can solve this. Lets discuss these options.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Post the output as plaintext&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Slack’s markdown support is pretty limited. It doesn’t support neither headings nor lists. This approach has one notable benefit. It’s one HTTP request.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Use &lt;a href=&quot;https://api.slack.com/docs/message-attachments&quot;&gt;message attachments&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This approach might sound interesting, but it’s not suitable for structured reports.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://api.slack.com/tutorials/working-with-files&quot;&gt;Upload report&lt;/a&gt; as markdown file&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This approach is the best option, but I haven’t had the time to implement it.&lt;/p&gt;

&lt;h3 id=&quot;deployment&quot;&gt;Deployment&lt;/h3&gt;

&lt;p&gt;I’ve set up a cron job to run the script every day at 10:00.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;00 09 * * * cd /home/ubuntu/toggl-report/ &amp;amp;&amp;amp; /home/ubuntu/toggl-report/env/bin/dotenv-run /home/ubuntu/toggl-report/env/bin/python /home/ubuntu/toggl-report/run-report.py &amp;gt;&amp;gt; /home/ubuntu/toggl-report/log.log 2&amp;gt;&amp;amp;1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The project is available on https://github.com/stlk/slack-toggl-report&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Next.js - server-side rendering bez práce</title>
   <link href="https://blog.rousek.name/2017/10/12/nextjs-server-side-rendering-bez-prace/"/>
   <updated>2017-10-12T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2017/10/12/nextjs-server-side-rendering-bez-prace</id>
   <content type="html">&lt;p&gt;Skvělý framework &lt;a href=&quot;https://github.com/zeit/next.js&quot;&gt;Next.js&lt;/a&gt; se dočkal už čtvrté verze. Oproti verzi 2, kterou jsem zmiňoval minule je výrazně rychlejší a má několik velmi zajímavých novinek.&lt;/p&gt;

&lt;h2 id=&quot;co-je-nextjs&quot;&gt;Co je Next.js&lt;/h2&gt;

&lt;p&gt;Next.js je minimalistický framework pro tvorbu React aplikací s důrazem na jednoduchost server‑side renderingu. Bere na starost pouze server‑side rendering, který zvládá dokonale a zbytek je opět na nás.&lt;/p&gt;

&lt;p&gt;Jak Next.js zapadá do současného trendu vývoje? Pro mě byl vždy problém nedosažitelnost server‑side renderingu na začínajících projektech a s tím související absence SEO. Místo toho, abych aplikaci poskládal v komponentách, musel jsem pracovat s dalším šablonovým jazykem a globálními styly v Django nebo Rails aplikaci.&lt;/p&gt;

&lt;p&gt;Frameworky jako Next.js a služby poskytující databázi s GraphQL API umožnili nový způsob prototypování nebo nastartování projektu. Vytvořit velmi jednoduchou aplikaci a napojit ji na &lt;a href=&quot;https://www.graph.cool/&quot;&gt;Graph.cool&lt;/a&gt;. Na GraphQL se ale podíváme později.&lt;/p&gt;

&lt;p&gt;Základní nastavení je popsáno v původním článku &lt;a href=&quot;http://blog.rousek.name/2017/06/19/nextjs-server-side-rendering-for-masses/&quot;&gt;Next.js - server side rendering for masses&lt;/a&gt;, teď se budu soustředit pouze na novinky.&lt;/p&gt;

&lt;h3 id=&quot;dynamic-import&quot;&gt;Dynamic Import&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/tc39/proposal-dynamic-import&quot;&gt;TC39 dynamic import&lt;/a&gt; je návrh způsobu jak odsunout načtení modulu na pozdější chvíli. V následujícím příkladu Next.js automaticky oddělí knihovnu moment.js do samostatného souboru, který načte až po uplynutí &lt;code class=&quot;highlighter-rouge&quot;&gt;setTimeout&lt;/code&gt;. Díky tomu můžeme zmenšit velikost hlavní aplikace.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;moment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;moment&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;moment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;moment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Do something with moment&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;dynamic-react-components&quot;&gt;Dynamic React Components&lt;/h3&gt;

&lt;p&gt;Dynamické importy umožňují importovat i komponenty. To nám umožní vyrenderovat na serveru jen důležitý obsah a obsah, který není zásadní pro vyhledávače můžeme stáhnout později. Jsou to například formuláře nebo infografika.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-jsx&quot; data-lang=&quot;jsx&quot;&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;dynamic&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;next/dynamic&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;DynamicForm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;dynamic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;../components/Form&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Header&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;Content is here!&lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DynamicForm&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;školení-nextjs&quot;&gt;Školení Next.js&lt;/h2&gt;

&lt;p&gt;Pořádám &lt;a href=&quot;https://react.coffee/#react-na-serveru&quot;&gt;Next.js workshop&lt;/a&gt;, kde si vyzkoušíme Next.js v praxi.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Tips for writing maintainable redux apps</title>
   <link href="https://blog.rousek.name/2017/09/22/tips-for-writing-maintainable-redux-apps/"/>
   <updated>2017-09-22T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2017/09/22/tips-for-writing-maintainable-redux-apps</id>
   <content type="html">&lt;p&gt;I attended great talk by &lt;a href=&quot;https://github.com/garbles&quot;&gt;Gabe Scholz&lt;/a&gt; which was full of useful and concise tips for writing better and more maintainable redux apps. It struck me that I was just recently coping with these issues so I decided to share my view on these issues.&lt;/p&gt;

&lt;h2 id=&quot;data-selector-functions&quot;&gt;Data selector functions&lt;/h2&gt;

&lt;p&gt;Instead of having same data retrieval logic in multiple places you can extract it to function and place it alongside your reducer. This makes refactoring so much easier.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;isLoaded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;globalState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;globalState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;transactions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;globalState&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;transactions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;loaded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;normalize-conditionals-at-the-boundary&quot;&gt;Normalize conditionals at the boundary&lt;/h2&gt;

&lt;p&gt;This cryptic name hides pretty simple idea. Sometimes it’s not easy to decide when you should create new action or just add parameter to existing one. The best way might be to write a new action for each user action. Don’t try to optimize the code by grouping together multiple user actions that result in similar outcomes.&lt;/p&gt;

&lt;p&gt;There are two benefits to this approach. Actions are easier to typecheck and it’s easier to remove functionality.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;NEXT_STEP&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;newStepName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;currentStepName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;success&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;NEXT_STEP_FAILURE&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;newStepName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;currentStepName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;failure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;NEXT_STEP_TIME_EXCEEDED&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;newStepName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;currentStepName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;time_exceeded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;try-redux-observable-instead-of-redux-saga&quot;&gt;Try redux-observable instead of redux-saga&lt;/h2&gt;

&lt;p&gt;When you have difficulties learning redux-saga, you might want to try redux-observable. They are both solving same issue. If  you are more familiar with RxJS than generators, redux-observable might be better fit for you.&lt;/p&gt;

&lt;h2 id=&quot;deterministic-reducers&quot;&gt;Deterministic reducers&lt;/h2&gt;

&lt;p&gt;When working with time or generating ID’s in initial state it might be better to initialize these values in action. This makes reducers easier to test.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;initialState&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;startTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Having “random” value in initial state makes snapshot-based testing a bit harder. Isolate this value in action so you can use different value in tests.&lt;/p&gt;

&lt;h2 id=&quot;avoid-logic-in-components&quot;&gt;Avoid logic in components&lt;/h2&gt;

&lt;p&gt;Write dumb components and use HOC when needed. When components are almost like templates, there’s almost no reason to test them. In this example &lt;code class=&quot;highlighter-rouge&quot;&gt;formatTime&lt;/code&gt; is tested on its own, so I got away with not testing this component.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-jsx&quot; data-lang=&quot;jsx&quot;&gt;&lt;span class=&quot;k&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;currentTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;duration&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;className=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;seekInfo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;formatTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;currentTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;
      /
      &lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;formatTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;duration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;div&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</content>
 </entry>
 
 <entry>
   <title>Going headless with Firefox - since '55</title>
   <link href="https://blog.rousek.name/2017/09/08/going-headless-with-firefox-since-55/"/>
   <updated>2017-09-08T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2017/09/08/going-headless-with-firefox-since-55</id>
   <content type="html">&lt;p&gt;Recently I found that Firefox supports &lt;a href=&quot;https://developer.mozilla.org/en-US/Firefox/Headless_mode&quot;&gt;headless mode&lt;/a&gt; on &lt;a href=&quot;https://developer.mozilla.org/en-US/Firefox/Releases/55&quot;&gt;Linux&lt;/a&gt; for a month now. &lt;a href=&quot;https://developer.mozilla.org/en-US/Firefox/Releases/56&quot;&gt;Windows and MacOS&lt;/a&gt; are now in beta and will be released on September 26, 2017. I was pretty excited to find out so I immediately switched over Travis configuration for Selenium tests in my Django project.&lt;/p&gt;

&lt;p&gt;When running CI in windowed I had to setup virtual framebuffer in &lt;code class=&quot;highlighter-rouge&quot;&gt;before_install&lt;/code&gt; of &lt;code class=&quot;highlighter-rouge&quot;&gt;.travis.yml&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;export DISPLAY=:99.0
sh -e /etc/init.d/xvfb start
sleep 3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Meaning that by going headless I could save at least three seconds of CI runtime!&lt;/p&gt;

&lt;h3 id=&quot;how-to-do-it&quot;&gt;How to do it?&lt;/h3&gt;

&lt;p&gt;All we need to do is to make sure that we are using at least Firefox 55 and then set &lt;code class=&quot;highlighter-rouge&quot;&gt;MOZ_HEADLESS=1&lt;/code&gt; environment variable. That’s right. One environment variable!&lt;/p&gt;

&lt;p&gt;My entire &lt;code class=&quot;highlighter-rouge&quot;&gt;.travis.yml&lt;/code&gt; from &lt;a href=&quot;https://github.com/stlk/auto-fisera&quot;&gt;auto-fisera&lt;/a&gt; project.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span class=&quot;na&quot;&gt;language&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;python&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;addons&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;firefox&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;latest&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;services&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;postgresql&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;python&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;3.6&quot;&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;before_install&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;wget https://github.com/mozilla/geckodriver/releases/download/v0.18.0/geckodriver-v0.18.0-linux64.tar.gz&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;mkdir geckodriver&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;tar -xzf geckodriver-v0.18.0-linux64.tar.gz -C geckodriver&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;export PATH=$PATH:$PWD/geckodriver&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;geckodriver --version&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;export MOZ_HEADLESS=1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# command to install dependencies&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;pip install -r requirements.txt&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# command to run tests&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;python manage.py test&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Keep in mind that headless mode is supported in Firefox 56 on Windows and MacOS.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Upload multiple files in Django admin</title>
   <link href="https://blog.rousek.name/2017/08/11/uploading-multiple-files-in-django-admin/"/>
   <updated>2017-08-11T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2017/08/11/uploading-multiple-files-in-django-admin</id>
   <content type="html">&lt;p&gt;In my current project I wanted to let user upload multiple photos at once in Django admin. I got intimidated by huge libraries that do this and dozens of other things. So I ended up using small tweak which works surprisingly well.&lt;/p&gt;

&lt;p&gt;All we need are two files. &lt;code class=&quot;highlighter-rouge&quot;&gt;change_form.html&lt;/code&gt; template override and &lt;code class=&quot;highlighter-rouge&quot;&gt;admin.py&lt;/code&gt;. Template needs to be located in following structure.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;├── admin.py
├── templates
│   ├── admin
│   │   └── catalog(app name)
│   │       └── car(model name)
│   │           └── change_form.html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In file &lt;code class=&quot;highlighter-rouge&quot;&gt;change_form.html&lt;/code&gt; we need to override &lt;code class=&quot;highlighter-rouge&quot;&gt;inline_field_sets&lt;/code&gt; block and include single &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;input&lt;/code&gt; there.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-django&quot; data-lang=&quot;django&quot;&gt;&lt;span class=&quot;cp&quot;&gt;{%&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;admin/change_form.html&quot;&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;%}&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;{%&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;block&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;inline_field_sets&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;%}&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;{%&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;inline_admin_formset&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;inline_admin_formsets&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;%}&lt;/span&gt;
    &lt;span class=&quot;cp&quot;&gt;{%&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;inline_admin_formset.opts.template&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;%}&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;{%&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;endfor&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;%}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;fieldset&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;module&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;h2&amp;gt;&lt;/span&gt;Upload Photos&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h2&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;photos_multiple&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;file&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;multiple&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/fieldset&amp;gt;&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;{%&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;endblock&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;%}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Then we need to handle data we receive when the model forms gets submitted. We will do that by overriding &lt;code class=&quot;highlighter-rouge&quot;&gt;save_model&lt;/code&gt; inside our model admin. All we need to do is reach out for &lt;code class=&quot;highlighter-rouge&quot;&gt;photos_multiple&lt;/code&gt; field and save all files that might be there. My &lt;code class=&quot;highlighter-rouge&quot;&gt;Car&lt;/code&gt; model references &lt;code class=&quot;highlighter-rouge&quot;&gt;photos&lt;/code&gt; which has only one &lt;code class=&quot;highlighter-rouge&quot;&gt;ImageField&lt;/code&gt; called &lt;code class=&quot;highlighter-rouge&quot;&gt;image&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CarAdmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;admin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ModelAdmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;save_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;change&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;afile&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FILES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getlist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'photos_multiple'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;photos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;afile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If everything worked out fine you should see &lt;em&gt;Upload Photos&lt;/em&gt; section under inline model. There’s a complete &lt;code class=&quot;highlighter-rouge&quot;&gt;admin.py&lt;/code&gt; below if you need a context.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;django.contrib&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;admin&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;.models&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Car&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Photo&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;PhotoInline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;admin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StackedInline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Photo&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;extra&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CarAdmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;admin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ModelAdmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;inlines&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PhotoInline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;save_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;change&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;afile&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FILES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getlist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'photos_multiple'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;photos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;afile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;admin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;site&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;register&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Car&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CarAdmin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;In later post I will probably cover how to configure Travis CI to run &lt;code class=&quot;highlighter-rouge&quot;&gt;LiveServerTestCase&lt;/code&gt;.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Automatizace platby převodem na Shopify pomocí Fakturoidu</title>
   <link href="https://blog.rousek.name/2017/07/03/automatizace-platby-prevodem-na-shopify/"/>
   <updated>2017-07-03T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2017/07/03/automatizace-platby-prevodem-na-shopify</id>
   <content type="html">&lt;p&gt;Můj klient potřeboval automatizovat platbu převodem v obchodě na platformě &lt;a href=&quot;https://www.shopify.com/?ref=developer-7be6616fd8bde970&quot;&gt;Shopify&lt;/a&gt;. Vymysleli jsme řešení, jak pomocí proformy využít schopnosti &lt;a href=&quot;https://www.fakturoid.cz&quot;&gt;Fakturoid.cz&lt;/a&gt;. Fakturoid při zaplacení proformy vytvoří fakturu a následně informuje o jejím vytvoření.&lt;/p&gt;

&lt;h4 id=&quot;ukážeme-si-jak-automaticky&quot;&gt;Ukážeme si jak automaticky:&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;poslat zákazníkovi platební informace&lt;/li&gt;
  &lt;li&gt;po zaplacení odeslat e-mail s fakturou&lt;/li&gt;
  &lt;li&gt;označit objednávku jako zaplacenou&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;jak-takový-proces-nastavit&quot;&gt;Jak takový proces nastavit?&lt;/h2&gt;

&lt;h3 id=&quot;základní-propojení&quot;&gt;Základní propojení&lt;/h3&gt;

&lt;p&gt;Do vašeho obchodu si nainstalujte aplikaci &lt;a href=&quot;https://apps.shopify.com/fakturoid-invoices?utm_source=blog&amp;amp;utm_medium=article&amp;amp;utm_campaign=proforma_guide&quot; target=&quot;_blank&quot;&gt;Send invoices to Fakturoid.cz&lt;/a&gt;. V sekci &lt;em&gt;Apps&lt;/em&gt; se objeví aplikace &lt;em&gt;Send invoices to Fakturoid.cz&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;Nejprve je nutné vyplnit přihlašovací údaje pro Fakturoid v sekci &lt;em&gt;Fakturoid credentials&lt;/em&gt;. [&lt;a href=&quot;https://youtu.be/ZjNwiaImy2Q&quot; target=&quot;_blank&quot;&gt;videonávod&lt;/a&gt;] A následně klinutím na &lt;em&gt;Enable proforma invoices&lt;/em&gt; v sekci &lt;em&gt;Proforma invoices&lt;/em&gt; zapnout vytváření proforma faktur při vytvoření objednávky.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/public/enable-proforma-invoices.png&quot; target=&quot;_blank&quot;&gt;
  &lt;img src=&quot;/public/enable-proforma-invoices.png&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Po zapnutí je ještě nutné nastavit &lt;em&gt;webhook&lt;/em&gt; ve Fakturoidu. [&lt;a href=&quot;https://youtu.be/mS6mlEcdEdU&quot; target=&quot;_blank&quot;&gt;videonávod&lt;/a&gt;] Webhook je způsob, jakým Fakturoid informuje aplikaci o zaplacené faktuře.&lt;/p&gt;

&lt;h3 id=&quot;platební-údaje-v-souhrnu-objednávky&quot;&gt;Platební údaje v souhrnu objednávky&lt;/h3&gt;

&lt;p&gt;Zbývá najít způsob, jak dostat platební údaje k zákazníkovi. K tomuto účelu je možné využít notifikační e-mail &lt;em&gt;Order confirmation&lt;/em&gt;. Proformy mají jako variabilní symbol nastavené číslo objednávky.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Návod předpokládá, že máte v sekci &lt;em&gt;Settings &amp;gt; Payments &amp;gt; Manual payments&lt;/em&gt; zapnutou platbu s názvem &lt;em&gt;Bank Deposit&lt;/em&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;/public/order-confirmation.png&quot; target=&quot;_blank&quot;&gt;
  &lt;img src=&quot;/public/order-confirmation.png&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;V šabloně najděte sekci &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;h4&amp;gt;Payment method&amp;lt;/h4&amp;gt;&lt;/code&gt;, konkrétně &lt;code class=&quot;highlighter-rouge&quot;&gt;{{ transaction.gateway | replace: &quot;_&quot;, &quot; &quot;...&lt;/code&gt;. Za &lt;code class=&quot;highlighter-rouge&quot;&gt;{% endif %}&lt;/code&gt; po tomto výrazu vložte kód uvozený &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;!-- Platební informace --&amp;gt;&lt;/code&gt; a &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;!-- / Platební informace --&amp;gt;&lt;/code&gt; dle příkladu.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-liquid&quot; data-lang=&quot;liquid&quot;&gt;&amp;lt;td class=&quot;customer-info__item&quot;&amp;gt;
  &amp;lt;h4&amp;gt;Payment method&amp;lt;/h4&amp;gt;
  ...
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;transaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;gateway&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;_&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;capitalize&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt; — &amp;lt;strong&amp;gt;&lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;transaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;money&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;&amp;lt;/strong&amp;gt;
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
    &amp;lt;!-- Platební informace --&amp;gt;
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;transaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;gateway&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Bank Deposit&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
      &amp;lt;p class=&quot;customer-info__item-content&quot;&amp;gt;
        &amp;lt;strong&amp;gt;Číslo účtu:&amp;lt;/strong&amp;gt; 123457/0000
      &amp;lt;/p&amp;gt;
      &amp;lt;p class=&quot;customer-info__item-content&quot;&amp;gt;
        &amp;lt;strong&amp;gt;Variabilní symbol:&amp;lt;/strong&amp;gt; &lt;span class=&quot;p&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}}&lt;/span&gt;
      &amp;lt;/p&amp;gt;
    &lt;span class=&quot;p&quot;&gt;{%&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;endif&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%}&lt;/span&gt;
    &amp;lt;!-- / Platební informace --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;doručení-faktury-zákazníkovi&quot;&gt;Doručení faktury zákazníkovi&lt;/h3&gt;

&lt;p&gt;Fakturoid umožňuje automatické odeslání faktury zákazníkovi po zaplacení proformy. V sekci &lt;em&gt;Nastavení &amp;gt; Emaily &amp;gt; Texty a způsob odesílání&lt;/em&gt; je záložka &lt;em&gt;Zaplacení proformy&lt;/em&gt;. Tuto záložku nastavte dle obrázku.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/public/fakturoid-nastaveni-emailu.png&quot; target=&quot;_blank&quot;&gt;
  &lt;img src=&quot;/public/fakturoid-nastaveni-emailu.png&quot; alt=&quot;&quot; class=&quot;post__image post__image-full-width&quot; /&gt;
&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Potřebujete pomoct s nastavením? Neváhejte mě kontaktovat na e-mailu josef@rousek.name.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Next.js - server side rendering for masses</title>
   <link href="https://blog.rousek.name/2017/06/19/nextjs-server-side-rendering-for-masses/"/>
   <updated>2017-06-19T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2017/06/19/nextjs-server-side-rendering-for-masses</id>
   <content type="html">&lt;p&gt;Recently I had opportunity to use &lt;a href=&quot;https://github.com/zeit/next.js&quot;&gt;Next.js&lt;/a&gt; on a client project. I already heard how much work it saves but I just couldn’t believe how simple it was.&lt;/p&gt;

&lt;p&gt;My requirements were following. Server rendered react application with jest as testing framework and &lt;a href=&quot;https://www.styled-components.com&quot;&gt;styled-components&lt;/a&gt; as the &lt;em&gt;best&lt;/em&gt; way to manage styles. If you aren’t interested in these be sure to checkout &lt;a href=&quot;https://zeit.co/blog/next2#more-examples&quot;&gt;blogpost announcing version 2.0&lt;/a&gt; of Next.js. There’s a bunch of examples showing integrations with other libraries.&lt;/p&gt;

&lt;p&gt;To grasp the basics I followed tutorial on &lt;a href=&quot;https://learnnextjs.com&quot;&gt;Learning Next.js&lt;/a&gt;. It got me through some early surprises. Eg. how route resolving is done on the server when using custom routes. But first lets take a look on how you define custom route. Magic is hidden behind the &lt;code class=&quot;highlighter-rouge&quot;&gt;as&lt;/code&gt; attribute and everything is handled automatically.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Link&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;`/post/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;href&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;`/post?id=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/a&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;
&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;sr&quot;&gt;/Link&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;On the other hand server configuration is done on, well, server level. We need to manually define a route and then tell &lt;code class=&quot;highlighter-rouge&quot;&gt;next.js&lt;/code&gt; which page is it. You can use plethora of nodejs servers as backend, but I’ve used the default one which is &lt;code class=&quot;highlighter-rouge&quot;&gt;express&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/post/:id&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;actualPage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/post&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;queryParams&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;actualPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;queryParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Please note that this is required only for server side rendering with custom routes.&lt;/p&gt;

&lt;h3 id=&quot;styled-components&quot;&gt;Styled components&lt;/h3&gt;

&lt;p&gt;First library I want to integrate is &lt;a href=&quot;https://github.com/zeit/next.js/tree/master/examples/with-styled-components&quot;&gt;styled-components&lt;/a&gt; integrating this library is pretty simple. Just copy &lt;code class=&quot;highlighter-rouge&quot;&gt;pages/_document.js&lt;/code&gt; from example repo. To not break server side rendering we need to use babel plugin called &lt;code class=&quot;highlighter-rouge&quot;&gt;babel-plugin-styled-components&lt;/code&gt;. Don’t forget to include &lt;code class=&quot;highlighter-rouge&quot;&gt;.babelrc&lt;/code&gt;, I prefer to keep my babel configuration in &lt;code class=&quot;highlighter-rouge&quot;&gt;package.json&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;hello-next&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;version&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;1.0.0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;description&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;main&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;index.js&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;babel&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;presets&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;next/babel&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;plugins&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;styled-components&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
          &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;ssr&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;scripts&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;dev&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;node server.js&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;tests-using-jest&quot;&gt;Tests using jest&lt;/h3&gt;

&lt;p&gt;To set up jest all you need to do is to add &lt;code class=&quot;highlighter-rouge&quot;&gt;env&lt;/code&gt; to &lt;a href=&quot;https://github.com/stlk/next-workshop/blob/master/package.json#L33&quot;&gt;babel presets&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I also have a &lt;a href=&quot;https://github.com/stlk/next-workshop/blob/master/test.js&quot;&gt;script&lt;/a&gt; that will automatically disable &lt;code class=&quot;highlighter-rouge&quot;&gt;watch&lt;/code&gt; when run on CI server.&lt;/p&gt;

&lt;h3 id=&quot;want-to-learn-more&quot;&gt;Want to learn more?&lt;/h3&gt;

&lt;p&gt;You can follow my progress on &lt;a href=&quot;https://github.com/stlk/next-workshop&quot;&gt;GitHub.com&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;školení-nextjs&quot;&gt;Školení Next.js&lt;/h3&gt;

&lt;p&gt;Vedu &lt;a href=&quot;https://react.coffee/#react-na-serveru&quot;&gt;Next.js workshop&lt;/a&gt;, kde si vyzkoušíme Next.js v praxi.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Why I got interested in GraphQL and why should you too</title>
   <link href="https://blog.rousek.name/2017/06/14/why-i-got-interested-in-graphql-and-why-should-you-too/"/>
   <updated>2017-06-14T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2017/06/14/why-i-got-interested-in-graphql-and-why-should-you-too</id>
   <content type="html">&lt;p&gt;GraphQL is query language created by developers in Facebook to make their app development manageable. There are quite a few reasons why should we be interested in it even at small scale.&lt;/p&gt;

&lt;h3 id=&quot;avoid-overfetching-and-underfetching&quot;&gt;Avoid overfetching and underfetching&lt;/h3&gt;
&lt;p&gt;Let client decide what data it wants. I will use GitHub’s GraphQL api as an example. Lets say I want to show number of issues for repositories I recently contributed to.&lt;/p&gt;

&lt;div class=&quot;language-graphql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;viewer&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;contributedRepositories&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;first&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;privacy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PUBLIC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orderBy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;field&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UPDATED_AT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;direction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DESC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nodes&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;issues&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
          &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;totalCount&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;GraphQL looks like JSON without values and GraphQL server fills in the values in shape we requested.&lt;/p&gt;

&lt;h3 id=&quot;formalize-writes&quot;&gt;Formalize writes&lt;/h3&gt;

&lt;p&gt;Writes and all other changes to the store are called mutations. They are queries with side-effects.&lt;/p&gt;

&lt;p&gt;First lets retrieve ID of repository I want to star.&lt;/p&gt;
&lt;div class=&quot;language-graphql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;repository&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;owner&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;django&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;django&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then use the ID as parameter. Plus we can specify what data offered by the mutation we want to receive.&lt;/p&gt;

&lt;div class=&quot;language-graphql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;mutation&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addStar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;starrableId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;MDEwOlJlcG9zaXRvcnk0MTY0NDgy&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;starrable&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__typename&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;avoid-implementing-data-fetching-logic&quot;&gt;Avoid implementing data fetching logic&lt;/h3&gt;

&lt;p&gt;GraphQL has variety of client libraries. Most notable ones are Relay and Apollo. They will help you with linking data from server directly to React components. You can find out more in &lt;a href=&quot;https://dev-blog.apollodata.com/reducing-our-redux-code-with-react-apollo-5091b9de9c2a&quot;&gt;Reducing our Redux code with React Apollo&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;great-language-support&quot;&gt;Great language support&lt;/h3&gt;

&lt;p&gt;Long gone are the times when GraphQL worked only in Javascript. There are great &lt;a href=&quot;https://github.com/chentsulin/awesome-graphql#lib&quot;&gt;libraries&lt;/a&gt; in &lt;a href=&quot;http://graphene-python.org/&quot;&gt;Python&lt;/a&gt;, Ruby, .NET and even Haskell.&lt;/p&gt;

&lt;p&gt;Want to learn more? Visit &lt;a href=&quot;http://graphql.org/learn/&quot;&gt;graphql.org/learn/&lt;/a&gt; or checkout my &lt;a href=&quot;https://react.coffee/#graphql-a-apollo&quot;&gt;GraphQL workshop&lt;/a&gt;.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Automatically format your javascript files on commit using Prettier</title>
   <link href="https://blog.rousek.name/2017/06/11/prettier-pre-commit/"/>
   <updated>2017-06-11T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2017/06/11/prettier-pre-commit</id>
   <content type="html">&lt;p&gt;I recently fell in love with &lt;a href=&quot;https://github.com/prettier/prettier&quot;&gt;prettier&lt;/a&gt;. Prettier is an opinionated code formatter.
Having consistently formatted code is very pleasant feeling for me and having formatting done automatically?
Woah! The best part is that you can easily run &lt;code class=&quot;highlighter-rouge&quot;&gt;prettier&lt;/code&gt; on &lt;code class=&quot;highlighter-rouge&quot;&gt;git commit&lt;/code&gt;. That way you can write messy code and it will get cleaned up automatically. Let’s do it.&lt;/p&gt;

&lt;p&gt;By combining three packages we can create pre-commit git hook that will transform javascript files using &lt;a href=&quot;https://github.com/prettier/prettier&quot;&gt;prettier&lt;/a&gt;. Those packages are &lt;code class=&quot;highlighter-rouge&quot;&gt;lint-staged&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;pre-commit&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;prettier&lt;/code&gt;.
To install them run &lt;code class=&quot;highlighter-rouge&quot;&gt;npm install --save-dev lint-staged pre-commit prettier&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Then add following keys to your &lt;code class=&quot;highlighter-rouge&quot;&gt;package.json&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;scripts&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;lint:staged&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;lint-staged&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;lint-staged&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;*.js&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;prettier --write --single-quote --trailing-comma=all&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;git add&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;pre-commit&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;lint:staged&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now when you commit you code you should see &lt;code class=&quot;highlighter-rouge&quot;&gt;✔ Running tasks for *.js&lt;/code&gt; message.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;git commit &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'Initial commit'&lt;/span&gt;
 ✔ Running tasks &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.js
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;master &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root-commit&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 7da3cc3] Initial commit
 13 files changed, 4841 insertions&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;+&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</content>
 </entry>
 
 <entry>
   <title>React Amsterdam 2017</title>
   <link href="https://blog.rousek.name/2017/04/30/react-amsterdam/"/>
   <updated>2017-04-30T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2017/04/30/react-amsterdam</id>
   <content type="html">&lt;p&gt;Last Friday I attended my first React conference. It took place in Amsterdam. So once again I got the opportunity to visit Amsterdam because of a conference. I want to thank organizers of &lt;a href=&quot;https://www.meetup.com/praguejs/&quot;&gt;PragueJS&lt;/a&gt; meetup for giving me a ticket!&lt;/p&gt;

&lt;p&gt;This was my biggest conference I ever attended and I must say the organization was pretty good. Location and technical production were perfect and overall I feel pretty positive about the conference.&lt;/p&gt;

&lt;p&gt;It started on Thursday when &lt;a href=&quot;https://twitter.com/TomislavTenodi&quot;&gt;Tomislav Tenodi&lt;/a&gt; organized unofficial warmup party. I love those small events when I’m forced to talk to people. For me it’s so much easier to meet people and it gets me into networking mood for a conference.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/react-amsterdam.jpg&quot; alt=&quot;&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;talks&quot;&gt;Talks&lt;/h2&gt;

&lt;h3 id=&quot;coding-mobile-with-the-pros&quot;&gt;Coding Mobile with the Pros&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://twitter.com/GantLaborde&quot;&gt;Gant Laborde&lt;/a&gt; started the React Native track. His company Infinite Red maintains some pretty interesting project and he came to introduce them.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/infinitered/reactotron&quot;&gt;Reactotron&lt;/a&gt; - Headlined a desktop app for inspecting your React Native projects. You can inspect and change the apps state from nice and simple UI.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://infinite.red/ignite&quot;&gt;Ignite&lt;/a&gt; - Great tool to simplify library usage. It links a library into your app and generates examples. Will definitely try it.&lt;/p&gt;

&lt;h3 id=&quot;a-real-world-graphql-application-in-production&quot;&gt;A Real-World GraphQL Application in Production&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://twitter.com/stefanomasini&quot;&gt;Stefano Masini&lt;/a&gt; presented advanced how they build GraphQL server at scale. He presented some interesting ways to introduce caching and organize mutations. Architecture they used is called &lt;a href=&quot;http://fideloper.com/hexagonal-architecture&quot;&gt;Hexagonal Architecture&lt;/a&gt;. He was also discussing GraphQL Subscriptions. They faced the problem of correctly subscribing to events. The approach they ended up using was to send all events happening on a page to a single channel.&lt;/p&gt;

&lt;h3 id=&quot;test-like-its-2017&quot;&gt;Test Like It’s 2017&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://twitter.com/MicheleBertoli&quot;&gt;Michele Bertoli&lt;/a&gt; is testing obsessed front end engineer working at Facebook. He presented few tools that will help us with testing.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/styled-components/jest-styled-components&quot;&gt;Jest utilities for Styled Components&lt;/a&gt; - Includes styled-components generated css in snapshots.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/styleguidist/snapguidist&quot;&gt;Snapguidist&lt;/a&gt; do snapshot-based testing inside your &lt;a href=&quot;https://github.com/styleguidist/react-styleguidist&quot;&gt;React Styleguidist&lt;/a&gt; styleguide.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/storybooks/storybook/tree/master/packages/storyshots&quot;&gt;StoryShots&lt;/a&gt; exactly same for &lt;a href=&quot;https://github.com/storybooks/storybook&quot;&gt;React Storybook&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/MicheleBertoli/react-fix-it&quot;&gt;React Fix It&lt;/a&gt; is a great tool which generates test when exceptions occurs. Why should we manually reproduce test case when the browser has all the info to generate it.&lt;/p&gt;

&lt;h3 id=&quot;navigating-react-native-navigation&quot;&gt;Navigating React Native Navigation&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://twitter.com/kurtiskemple&quot;&gt;Kurtis Kemple&lt;/a&gt; and his team invested quite some time into investigating which router would suit them the most. He decided to share their learnings with us.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/airbnb/native-navigation&quot;&gt;Native Navigation&lt;/a&gt; promising approach based on building thin layer over native components.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/react-community/react-navigation&quot;&gt;React Navigation&lt;/a&gt; is aiming to share navigation logic between mobile apps, web apps, and server rendering.&lt;/p&gt;

&lt;p&gt;I personally have used &lt;a href=&quot;https://github.com/aksonov/react-native-router-flux&quot;&gt;React Native Router&lt;/a&gt; and I’m quite happy with it.&lt;/p&gt;

&lt;h3 id=&quot;complexity-divide-and-conquer&quot;&gt;Complexity: Divide and Conquer!&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://twitter.com/mweststrate&quot;&gt;Michel Weststrate&lt;/a&gt; author of MobX shared his thoughts on managing complexity.&lt;/p&gt;

&lt;p&gt;What does &lt;em&gt;reactive&lt;/em&gt; mean? Separate &lt;em&gt;when&lt;/em&gt; and &lt;em&gt;how&lt;/em&gt;. What does it mean? Well that you can separate your app login from view layer(React).&lt;/p&gt;

&lt;p&gt;I also learned one new MobX function called &lt;a href=&quot;https://mobx.js.org/refguide/when.html&quot;&gt;when&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;flow-typing-a-react-codebase&quot;&gt;Flow Typing a React Codebase&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://twitter.com/ForbesLindesay&quot;&gt;Forbes Lindesay&lt;/a&gt; author of &lt;a href=&quot;https://github.com/ForbesLindesay/cabbie&quot;&gt;Cabbie&lt;/a&gt; a webdriver client for node.js and front end engineer at Facebook has shared his tips on &lt;a href=&quot;https://flow.org&quot;&gt;flow&lt;/a&gt;.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Mark files for typechecking using &lt;code class=&quot;highlighter-rouge&quot;&gt;//@flow&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Use &lt;code class=&quot;highlighter-rouge&quot;&gt;any&lt;/code&gt; type only for experiments.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mixed&lt;/code&gt; type is fine, it means that return value doesn’t matter.&lt;/li&gt;
  &lt;li&gt;Use &lt;a href=&quot;https://flow.org/en/docs/types/objects/#toc-exact-object-types&quot;&gt;Exact object types&lt;/a&gt; it helps you catch some typos.&lt;/li&gt;
  &lt;li&gt;Use &lt;a href=&quot;https://flow.org/en/docs/types/interfaces/#toc-covariant-read-only-properties-on-interfaces&quot;&gt;read-only properties &lt;/a&gt; by default.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;party-warmup&quot;&gt;Party warmup&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://twitter.com/vincentriemer&quot;&gt;Vincent Riemer&lt;/a&gt; author of fully recreated web-based &lt;a href=&quot;https://io808.com&quot;&gt;TR-808&lt;/a&gt; drum machine and &lt;a href=&quot;https://twitter.com/batchass&quot;&gt;Bruce Lane&lt;/a&gt; have prepared audiovisual party warmup talk about sound in React.&lt;/p&gt;

&lt;p&gt;And at the afterparty I finally managed to meet &lt;a href=&quot;https://twitter.com/mxstbr&quot;&gt;Max Stoiber&lt;/a&gt;. He was mentor of a &lt;a href=&quot;https://railsgirlssummerofcode.org/blog/2016-10-01-goodbye-xyz&quot;&gt;Rails Girls SoC team&lt;/a&gt; I was coaching.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/react-amsterdam-party.jpg&quot; alt=&quot;&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;amsterdam-and-around&quot;&gt;Amsterdam and around&lt;/h2&gt;

&lt;p&gt;This time I was staying at Haarlem. City about 15 minutes by train away from Amsterdam Centraal. The day after conference I decided to take a hike through Nationaal Park Zuid-Kennemerland.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/react-amsterdam-park.jpg&quot; alt=&quot;&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Then I really needed coffee so went back to Screaming Beans coffee. It’s lovely small café with tasty coffee.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/react-amsterdam-screaming-beans.jpg&quot; alt=&quot;&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>On writing and publishing Shopify application</title>
   <link href="https://blog.rousek.name/2017/03/27/on-writing-and-publishing-shopify-app/"/>
   <updated>2017-03-27T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2017/03/27/on-writing-and-publishing-shopify-app</id>
   <content type="html">&lt;p&gt;Recently I got interested in small and hopefully profitable projects, sometimes called Micropreneurship. Later I found that one of the most “simple” ways to start a SAAS is Shopify application.&lt;/p&gt;

&lt;p&gt;Shopify applications are standalone websites integrated with Shopify using their API and doing something that store owners find useful and would be willing to pay for it. The part that makes it easier is that your app will be published on &lt;a href=&quot;https://apps.shopify.com&quot;&gt;Shopify app store&lt;/a&gt;. There’s already pretty strong competition but there are still places offering opportunity.&lt;/p&gt;

&lt;p&gt;Trying to find a Django project I could work on I realized there is no &lt;a href=&quot;https://www.fakturoid.cz&quot;&gt;Fakturoid.cz&lt;/a&gt; integration. That was exactly it! Simple integration exposing webhook on one side and creating invoice on the other side.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;a href=&quot;https://apps.shopify.com/fakturoid-invoices?utm_source=blog&amp;amp;utm_medium=article&amp;amp;utm_campaign=writing_app&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;/public/shopify-appstore-banner.png&quot; alt=&quot;&quot; class=&quot;post__image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But how to start? Luckily &lt;a href=&quot;http://gavinballard.com&quot;&gt;Gavin Ballard&lt;/a&gt; shares quite a lot of his Shopify expertise and even published two packages I found very helpful.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/discolabs/django-shopify-auth&quot;&gt;Django Shopify Auth&lt;/a&gt; takes care of all the steps required to retrieve, store and use sellers credentials. Second package is &lt;a href=&quot;https://github.com/discolabs/django-shopify-webhook&quot;&gt;Django Shopify Webhook&lt;/a&gt; which handles verification of request’s authenticity. I &lt;a href=&quot;https://github.com/discolabs/django-shopify-webhook/pull/3&quot;&gt;helped&lt;/a&gt; to make this package work on Python 3.6.&lt;/p&gt;

&lt;p&gt;Shopify maintains &lt;a href=&quot;https://github.com/Shopify/shopify_python_api&quot;&gt;Python client&lt;/a&gt; for their API. Using these three packages I was able to create basic skeleton pretty fast. There were two roadblocks on the way. I already mentioned the first one. Second one was just overall understanding of how do applications integrate with Shopify. Especially what Embedded app is and how it differs from original integrations.&lt;/p&gt;

&lt;p&gt;Embedded apps are supposed to make user feel like he has never left Shopify. There is a great CSS framework called &lt;a href=&quot;https://github.com/MONEI/Shopify-Embedded-App-Frontend-Framework&quot;&gt;Shopify Embedded App Frontend Framework&lt;/a&gt; which I’ve used.&lt;/p&gt;

&lt;p&gt;It surprised me how everyone I’ve encountered was happy to help and willing to share their knowledge. From Gavin whose packages simplify app development by a great deal to Philip from Shopify Apps Team who was always kind to me during the approval process.&lt;/p&gt;

&lt;p&gt;Are you thinking about building your own Shopify app or want me to build you one? Let me know either way! I will be happy to talk to you. The one I build helps creating invoices needed in Czech republic called &lt;a href=&quot;https://apps.shopify.com/fakturoid-invoices&quot;&gt;Send invoices to Fakturoid.cz&lt;/a&gt;.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Expose local port as HTTPS endpoint on the internet</title>
   <link href="https://blog.rousek.name/2017/01/21/expose-local-port-as-https-endpoint/"/>
   <updated>2017-01-21T00:00:00-06:00</updated>
   <id>https://blog.rousek.name/2017/01/21/expose-local-port-as-https-endpoint</id>
   <content type="html">&lt;p&gt;I recently needed to expose local port of my dev machine to the internet. I realized I could combine SSH port forwarding, nginx and letsencrypt. Ubuntu 16.04 is my OS of choice on the server.&lt;/p&gt;

&lt;p&gt;I did this mostly to try out letsencrypt. If this looks too complicated for you, you might want to consider using &lt;a href=&quot;https://ngrok.com&quot;&gt;ngrok&lt;/a&gt; or similar service.&lt;/p&gt;

&lt;h2 id=&quot;port-forwarding&quot;&gt;Port forwarding&lt;/h2&gt;

&lt;p&gt;Exposing local port using port forwarding is pretty simple assuming you have linux server which you can access by ssh. Let’s expose our local port 8000 as port 80 on yourserver.example.com.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; user@yourserver.example.com &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; 80:localhost:8000&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This was easy. Now the harder part, HTTPS.&lt;/p&gt;

&lt;h2 id=&quot;getting-the-certificate&quot;&gt;Getting the certificate&lt;/h2&gt;

&lt;p&gt;I followed tutorial written by &lt;a href=&quot;https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-16-04&quot;&gt;Mitchell Anicas&lt;/a&gt;. If you get lost on a way please refer back to it. First, let’s install &lt;code class=&quot;highlighter-rouge&quot;&gt;nginx&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;letsencrypt&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-get update
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;nginx letsencrypt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Letsencrypt needs a way to verify that you control the domain name by visiting &lt;code class=&quot;highlighter-rouge&quot;&gt;http://yourserver.example.com/.well-known/SOMETHING&lt;/code&gt;. We will use Webroot plugin to automatically create the file for us. Depending on your nginx configuration, you may need to explicitly allow access to the &lt;code class=&quot;highlighter-rouge&quot;&gt;/.well-known&lt;/code&gt; directory.&lt;/p&gt;

&lt;p&gt;Open default nginx site config:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nano /etc/nginx/sites-available/default&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Inside the &lt;code class=&quot;highlighter-rouge&quot;&gt;server&lt;/code&gt; block, add new location:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-nginx&quot; data-lang=&quot;nginx&quot;&gt;    &lt;span class=&quot;k&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;/.well-known&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;allow&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now apply our new configuration:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl reload nginx&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Let’s finally get the certificate!&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;letsencrypt certonly &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; webroot &lt;span class=&quot;nt&quot;&gt;--webroot-path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/www/html &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; yourserver.example.com&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Letsencrypt will probably ask for your email and if everything succeeds you should be able to see your certificate in following directory(substituting in your domain name):&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; /etc/letsencrypt/live/your_domain_name&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;https-proxy&quot;&gt;HTTPS proxy&lt;/h2&gt;

&lt;p&gt;HTTPS configuration is hard, luckily there are configurations we can just copy. It’s a good practice to generate strong &lt;a href=&quot;https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange&quot;&gt;Diffie-Hellman group&lt;/a&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;openssl dhparam &lt;span class=&quot;nt&quot;&gt;-out&lt;/span&gt; /etc/ssl/certs/dhparam.pem 2048&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Next, let’s create snippet with decent SSL configuration.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nano /etc/nginx/snippets/ssl-params.conf&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-nginx&quot; data-lang=&quot;nginx&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# from https://cipherli.st/ and https://raymii.org/s/tutorials/Strong_SSL_Security_On_nginx.html
&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ssl_protocols&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;TLSv1&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;TLSv1.1&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;TLSv1.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ssl_prefer_server_ciphers&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ssl_ciphers&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ssl_ecdh_curve&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;secp384r1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ssl_session_cache&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;shared:SSL:10m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ssl_session_tickets&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ssl_stapling&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;ssl_stapling_verify&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;resolver&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;.8.8.8&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;.8.4.4&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;valid=300s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;resolver_timeout&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;5s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;add_header&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Strict-Transport-Security&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;max-age=63072000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;includeSubdomains&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;add_header&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;X-Frame-Options&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;DENY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;add_header&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;X-Content-Type-Options&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;nosniff&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;ssl_dhparam&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/etc/ssl/certs/dhparam.pem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Be careful about &lt;code class=&quot;highlighter-rouge&quot;&gt;add_header X-Frame-Options DENY;&lt;/code&gt;, this setting will prevent your site from being embedded in &lt;code class=&quot;highlighter-rouge&quot;&gt;IFRAME&lt;/code&gt;. Last task left for us before creating a new tunnel is site configurations. Replace &lt;code class=&quot;highlighter-rouge&quot;&gt;yourserver.example.com&lt;/code&gt; with your own domain name. Taking port &lt;code class=&quot;highlighter-rouge&quot;&gt;80&lt;/code&gt; just for port forwarding is not really helpful with nginx installed, let’s use port &lt;code class=&quot;highlighter-rouge&quot;&gt;1111&lt;/code&gt; instead.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;nano /etc/nginx/sites-available/default&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-nginx&quot; data-lang=&quot;nginx&quot;&gt;&lt;span class=&quot;k&quot;&gt;server&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kn&quot;&gt;server_name&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;yourserver.example.com&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kn&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/var/www/html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kn&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;proxy_set_header&lt;/span&gt;   &lt;span class=&quot;s&quot;&gt;X-Real-IP&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$remote_addr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;proxy_set_header&lt;/span&gt;   &lt;span class=&quot;s&quot;&gt;Host&lt;/span&gt;      &lt;span class=&quot;nv&quot;&gt;$http_host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;proxy_pass&lt;/span&gt;         &lt;span class=&quot;s&quot;&gt;http://127.0.0.1:1111&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;proxy_set_header&lt;/span&gt;   &lt;span class=&quot;s&quot;&gt;X-Forwarded-For&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$proxy_add_x_forwarded_for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;proxy_set_header&lt;/span&gt;   &lt;span class=&quot;s&quot;&gt;X-Forwarded-Ssl&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kn&quot;&gt;proxy_set_header&lt;/span&gt;   &lt;span class=&quot;s&quot;&gt;X-Forwarded-Proto&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$scheme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kn&quot;&gt;listen&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kn&quot;&gt;listen&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;[::]:80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kn&quot;&gt;listen&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;443&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;ssl&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;http2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kn&quot;&gt;listen&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;[::]:443&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;ssl&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;http2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kn&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;snippets/ssl-params&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;.conf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kn&quot;&gt;ssl_certificate&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/etc/letsencrypt/live/yourserver.example.com/fullchain.pem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kn&quot;&gt;ssl_certificate_key&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/etc/letsencrypt/live/yourserver.example.com/privkey.pem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kn&quot;&gt;location&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;/.well-known&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
         &lt;span class=&quot;kn&quot;&gt;allow&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Reload the nginx configuration and try visiting your server with &lt;code class=&quot;highlighter-rouge&quot;&gt;https&lt;/code&gt;. You should see green lock and &lt;code class=&quot;highlighter-rouge&quot;&gt;Bad Gateway&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh &lt;span class=&quot;nt&quot;&gt;-N&lt;/span&gt; user@yourserver.example.com &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; 1111:localhost:8000&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After you created the tunnel you should see the server you are running on your machine on port 8000. In case you don’t have server ready you can start python server which serves files in current directory.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; SimpleHTTPServer 8000&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</content>
 </entry>
 
 <entry>
   <title>Převléknutí plastových reproduktorů do stylovější podoby</title>
   <link href="https://blog.rousek.name/2016/12/21/repackaging-cheap-speakers/"/>
   <updated>2016-12-21T00:00:00-06:00</updated>
   <id>https://blog.rousek.name/2016/12/21/repackaging-cheap-speakers</id>
   <content type="html">&lt;p&gt;Už jsou to tři roky, co jsem rozebral plastové reproduktory a jejich elektroniku naskládal do krabice od vína a přikryl lepenkou z IKEA. Chtěl jsem jednu bednu, ideálně s bluetooth, ale nepotřebuji drahý stylový reproduktor. Nedlouho poté jsem svůj výtvor vylepšil bluetooth příjmačem a designová reprobedna byla na světě.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/speaker-prototype.jpg&quot; alt=&quot;&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Skok do přítomnosti a papír nahradilo dřevo. Konkrétně laserem vyřezaná 2mm překližka. Použitelný návrh se mi podařilo udělat na první pokus, i když oválný reproduktor je velká výzva a nevyšel přesně dle očekávání.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/speaker-finished.jpg&quot; alt=&quot;&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Další velkou výzvou se úkázalo být upevění reproduktoru bez zásahu do konstrukce bedny. Připadal jsem si jako MacGyver, když jsem v touze desku vyzkoušet hned večer, vymýšlel způsob upevnění. První nápad přiletovat matku k reproduktoru jsem z obav z pevnosti zavrhnul a rozhodl se pro méně invazivní postup. U kulatého reproduktoru jsem šroubek utáhnul na reproduktoru obráceně a druhou matkou pak reproduktor zvenku připevnil. Do dírek u oválného reproduktoru se vešla gumová kabelová průchodka, stačilo tedy použít samořezné šrouby z vnější strany.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/speaker-detail.jpg&quot; alt=&quot;&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Mám doma ještě pár krabic od vína, objednal jsem si tedy bluetooth modul a malý zesilovač a zkouším jak kvalitní jsou komponenty z Číny. Co to je vlastně za produkty a jestli je koupit a případně jak je použít napíšu až budu vědět více.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Django: Under The Hood</title>
   <link href="https://blog.rousek.name/2016/11/12/django-under-hood/"/>
   <updated>2016-11-12T00:00:00-06:00</updated>
   <id>https://blog.rousek.name/2016/11/12/django-under-hood</id>
   <content type="html">&lt;p&gt;This year I a had an opportunity to attend &lt;a href=&quot;https://djangounderthehood.com&quot;&gt;Django: Under The Hood&lt;/a&gt;. A single track conference focused solely on Django. Due to a fact that significant number of contributors are attending, it’s great opportunity to discuss almost any issue with people who actually have a clue what is going on.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/amsterdam-biking.jpg&quot; alt=&quot;Amsterdam&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The conference takes place in Amsterdam. Amsterdam is wonderful city especially for me as a newbie cyclist. It’s fascinating to see so many people using bikes when infrastructure supports it.&lt;/p&gt;

&lt;p&gt;I decided to stay in a hostel so I could be able to walk almost anywhere and stay on budget. I picked Cocomama which turned out to be great choice. I picked room for 6 people, but I had the room for myself for two nights before the weekend! Another cool thing is that there’s a cat in the kitchen! Every morning he wanted me to let him go to the garden.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/amsterdam-cocomama.jpg&quot; alt=&quot;Joop the cat&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;All the talks were great and insightful, but four of them were very interesting for me. Andrew Godwin talked about &lt;a href=&quot;https://channels.readthedocs.io/&quot;&gt;Channels&lt;/a&gt;. He talked about what do channels solve, how do they work and what is the current state.&lt;/p&gt;

&lt;p&gt;Jennifer Akullian shared how keen.io takes care about their employee’s mental health and what steps should we all take when we feel somewhat weird. She started the talk describing her mental condition which really helped to emphasize her words.&lt;/p&gt;

&lt;p&gt;For last three months I’ve worked as a fullstack JavaScript developer so I didn’t expect to learn anything new from Idan Gazit’s talk Modern JavaScript, but I actually did. I can ditch semicolons altogether when I don’t start lines with backtick &lt;code&gt;`&lt;/code&gt;, open parens &lt;code class=&quot;highlighter-rouge&quot;&gt;(&lt;/code&gt; or open bracket &lt;code class=&quot;highlighter-rouge&quot;&gt;[&lt;/code&gt;. Idan did a great job describing current state of JavaScript, which is very complex for newcomers.&lt;/p&gt;

&lt;p&gt;Carl Meyer has joined Instagram only 6 months ago but as an experienced core Django contributor he had no trouble describing history of Django at Instagram. He also focused on how is code deployed and monitored with such a huge user base.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/duth-carl.jpg&quot; alt=&quot;Carl Meyer&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Sprints are as important as talks are on this conference. I would say that almost every attendee came to sprints as well. This time sprints took place at Impact Hub Amsterdam. For me, being Impact Hub Prague fan, I was happy to visit Hub abroad.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/amsterdam-impacthub.jpg&quot; alt=&quot;Impact Hub Amsterdam&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;During sprints I skimmed through Django’s issue tracker and found one task that seemed reasonable. Its an &lt;a href=&quot;https://code.djangoproject.com/ticket/27370&quot;&gt;issue&lt;/a&gt; where required attribute on &lt;code class=&quot;highlighter-rouge&quot;&gt;select&lt;/code&gt; causes HTML validation failures in some cases.&lt;/p&gt;

&lt;p&gt;I managed to pull out the fix in few hours and at four o’clock I already had first code review. There were various places I missed something or just didn’t know about, but all the reviewers were really friendly and helpful.&lt;/p&gt;

&lt;p&gt;We went through several iterations and I learned a lot about Python and Django during my work on this issue. So I totally recommend contributing to opensource to everyone.&lt;/p&gt;

&lt;p&gt;On this day there were also eleven dinners with organizers and/or contributors. I attended one focused on topic “My first experience with the Django community was…” which attracted people involved in Django Girls and PyLadies. I appreciate such activities, because its really helps people with networking!&lt;/p&gt;

&lt;p&gt;Organizers did a splendid job and I had a wonderful time during Django: Under The Hood. I’m happy to be part of this wonderful community.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Nodemon: Breakpoints in node applications</title>
   <link href="https://blog.rousek.name/2016/08/26/nodemon-cool-breakpoints/"/>
   <updated>2016-08-26T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2016/08/26/nodemon-cool-breakpoints</id>
   <content type="html">&lt;p&gt;Nodemon is tool to improve backend JS development. It reloads files automatically so you don’t have to restart the server every time. Another cool thing is that you can debug the code in chrome dev tools.&lt;/p&gt;

&lt;p&gt;Lets take the express generated site as environment.&lt;/p&gt;

&lt;p&gt;Fist we need to install nodemon.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;npm i nodemon&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Then run nodemon with &lt;code class=&quot;highlighter-rouge&quot;&gt;--inspect&lt;/code&gt; parameter&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;node ./node_modules/nodemon/bin/nodemon.js &lt;span class=&quot;nt&quot;&gt;--inspect&lt;/span&gt; ./bin/www&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;You can browse the code and even set breakpoints by clicking on the line number. This way you can inspect variables without having to use &lt;code class=&quot;highlighter-rouge&quot;&gt;console.log&lt;/code&gt;.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/nodemon-folder.png&quot; alt=&quot;How to get to source code&quot; class=&quot;post__image-full-width&quot; /&gt;&lt;/p&gt;

&lt;p&gt;When you are done, click play icon to continue execution of a program.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/nodemon-continue.png&quot; alt=&quot;How to continue program&quot; class=&quot;post__image-full-width&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Thanks &lt;a href=&quot;https://twitter.com/mxstbr/status/768597725625454592&quot;&gt;@mxstbr&lt;/a&gt; for bringing this up.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Python, LEDs and WiFi</title>
   <link href="https://blog.rousek.name/2016/08/19/python-leds-and-wifi/"/>
   <updated>2016-08-19T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2016/08/19/python-leds-and-wifi</id>
   <content type="html">&lt;p&gt;I lost interest in electrotechnics almost a year ago. I turned off my binary clock, temperature sensor and left it in a drawer. But before that I bought ESP8266, cheap WiFi microcontroller running lua. It was unreliable and hard to program.&lt;/p&gt;

&lt;p&gt;Fast forward year later I was stuck in a bed on a sunny summer day. I remembered local PyLadies group is going to hold an ESP8266 workshop. Out of pure boredom I decided to give it another chance, this time using the MicroPython project. I was pretty lucky as it was only few days after they released &lt;a href=&quot;https://micropython.org/download/#esp8266&quot;&gt;binaries&lt;/a&gt; for ESP8266 to the public.&lt;/p&gt;

&lt;p&gt;First you need to flash the board using following commands.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;esptool.py &lt;span class=&quot;nt&quot;&gt;--port&lt;/span&gt; /dev/tty.wchusbserial1420 erase_flash
esptool.py v1.0.2-dev
Connecting...
Erasing flash &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;this may take a &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;...

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;esptool.py &lt;span class=&quot;nt&quot;&gt;--port&lt;/span&gt; /dev/tty.wchusbserial1420 write_flash &lt;span class=&quot;nt&quot;&gt;--flash_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;8m 0 esp8266-2016-07-31-v1.8.2-75-g4d22ade.bin
esptool.py v1.2-dev
Connecting...
Running Cesanta flasher stub...
Flash params &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;to 0x0020
Writing 540672 @ 0x0... 540672 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;100 %&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Wrote 540672 bytes at 0x0 &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;13.1 seconds &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;330.8 kbit/s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;...
Leaving...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After restarting the device you can connect to python terminal using serial console of your choice. For me it is &lt;code class=&quot;highlighter-rouge&quot;&gt;screen /dev/tty.wchusbserial1420 115200&lt;/code&gt;. You can then play around in REPL. I’m using &lt;a href=&quot;https://github.com/nodemcu/nodemcu-devkit&quot;&gt;NodeMCU&lt;/a&gt; so I have blue led on port 16 so the first thing I did was to turn it on.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;machine&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;machine&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Pin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;machine&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Pin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OUT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;low&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# pull the pin low to turn on the light&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;To develop more complex applications it would be great to have a way to upload files to the module. Luckily there’s tool called &lt;a href=&quot;https://github.com/micropython/webrepl&quot;&gt;webrepl_cli&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Lets create file called &lt;code class=&quot;highlighter-rouge&quot;&gt;light.py&lt;/code&gt; with following content.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;machine&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;machine&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Pin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;machine&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Pin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OUT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;low&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;high&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;And upload it to the device using following command.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python webrepl_cli.py light.py 192.168.1.251:/
put 192.168.1.251 8266
light.py -&amp;gt; /light.py
Password:
Sent 326 of 326 bytes&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;blockquote&gt;
There's a chance that the command fails. Thats because webrepl might not be enabled by default. To enable it run &lt;code&gt;import webrepl; webrepl.start();&lt;/code&gt;.
&lt;/blockquote&gt;

&lt;p&gt;You can then use the file like every other module.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;light&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;light&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;light&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;off&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Micropython supports various protocols. Eg. &lt;a href=&quot;http://docs.micropython.org/en/latest/esp8266/esp8266/quickref.html#onewire-driver&quot;&gt;onewire&lt;/a&gt;, &lt;a href=&quot;http://docs.micropython.org/en/latest/esp8266/esp8266/quickref.html#neopixel-driver&quot;&gt;neopixel&lt;/a&gt; and &lt;a href=&quot;http://docs.micropython.org/en/latest/esp8266/esp8266_contents.html&quot;&gt;others&lt;/a&gt;. I had some leftover DS18B20 temperature sensor and neopixel LED so I combined them together and created WiFi thermometer with RGB status LED.&lt;/p&gt;

&lt;p&gt;Let’s start with the temperature sensor.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;n&quot;&gt;pin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;machine&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Pin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# the sensor is on GPIO14
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;onewire&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DS18B20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;onewire&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OneWire&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;roms&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# scan for devices on the bus
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'found devices:'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;roms&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'temperature:'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;' '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convert_temp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# tell the sensor to start reading temperature
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sleep_ms&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;750&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# sensor needs some time read the temperature
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_temp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;roms&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# we know we only have one sensor connected
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The NeoPixel is even simpler. I created &lt;a href=&quot;https://github.com/stlk/micropython/blob/master/temperature/status.py&quot;&gt;module&lt;/a&gt; that allows me to set the color using just one method call.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;from machine import Pin
from neopixel import NeoPixel

pin &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Pin&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4, Pin.OUT&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# the NeoPixel is on GPIO2&lt;/span&gt;
np &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; NeoPixel&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;pin, 1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# only one pixel is connected&lt;/span&gt;

np[0] &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;255, 128, 0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
np.write&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;With temperature reading and status notifications last part left to do is to send the data somewhere. At first I tried to send HTTP requests, but it wasn’t working well for some reason.&lt;/p&gt;

&lt;p&gt;My next shot was &lt;a href=&quot;https://github.com/micropython/micropython-lib/tree/master/umqtt.simple&quot;&gt;MQTT&lt;/a&gt;, which is lightweight publish/subscribe messaging transport designed especially for small devices. MicroPython implementation implements only subset of the protocol, the one I missed the most is authentication, because I couldn’t use hosted MQTT server and had to start one myself.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# You can find the library on https://github.com/micropython/micropython-lib/tree/master/umqtt.simple
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;umqtt.simple&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MQTTClient&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MQTTClient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'umqtt_client'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'example.com'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;publish&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'status'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'hi'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# send message &quot;hi&quot; to channel &quot;status&quot;
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;publish&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'temp'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;s'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;temp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# send temperature reading to channel &quot;temp&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I really enjoyed diving back to electrotechnics especially with python as a language of choice. You can find the finished project on &lt;a href=&quot;https://github.com/stlk/micropython/tree/master/temperature&quot;&gt;Github&lt;/a&gt;.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Island: část 2.</title>
   <link href="https://blog.rousek.name/2016/07/06/island/"/>
   <updated>2016-07-06T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2016/07/06/island</id>
   <content type="html">&lt;p&gt;Cesta do Þórsmörk pro nás začíná u vodopádu Seljalandsfoss. Vodopád &lt;a href=&quot;https://www.instagram.com/p/BFoHwPTjAJC/&quot;&gt;Seljalandsfoss&lt;/a&gt; jsme pocítili na vlastní kůži, dopad vody, která už ve vzduchu působí úžasným dojmem, vytváří mlhu rozlétávající se do okolí. V jeho blízkosti je ještě jeden, velmi zajímavý vodopád zvaný Gljúfrabúi. Je totiž skrytý ve skalní průrvě.&lt;/p&gt;

&lt;p&gt;Dost ale vodopádů a pojďme do kopců. Kvůli tomu přichází na řadu dlouho očekávaný &lt;a href=&quot;https://www.instagram.com/p/BGJb-KMSRS8/&quot;&gt;offroad autobus&lt;/a&gt;, od našeho cíle nás totiž dělí přibližně pět řek a říček.&lt;/p&gt;

&lt;p&gt;Hned po příjezdu jsme se do jednoho kopce pustili. Podařilo se nám vyhrabat k rozcestí. Jedna odbočka vedla přes zasněžený svah. Druhá pokračovala dále nahoru a netušil jsem, co by nás čekalo nahoře. Rozhodli jsme se vrátit se zpět, i když návrat byl neméně děsivý. Schody bez zábradlí na kraji srázu byly děsivé už při cestě nahoru, cestu dolů jsem považoval za nemožnou. Lepší výzvu pro zdolání strachu z výšek jsem si nemohl přát. Nakonec jsme v „klidu“ slezli dolů a já jsem si za odměnu dal venkovní saunu s následnou ledovou sprchou.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/island-thorsmork.jpg&quot; alt=&quot;Ledovec Eyjafjallajökull&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Odměna pro nás oba byla připravena hned na další den. Bazén Seljavallalaug je přibližně 10 minut pěšky od konce silnice. Částečně betonovaný bazén napájený horkým pramenem vybudovaný dobrovolníky v roce 1929. Převlékárny bez sprch jsou nečekaným komfortem a výhled na zasněžené vrcholky je dokonalý.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/island-seljavallalaug.jpg&quot; alt=&quot;Bazén Seljavallalaug&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Konec našeho roadtripu po Islandu se začíná ošklivě blížit. Cestou zpět už jen maják na poloostrově &lt;a href=&quot;https://www.instagram.com/p/BFxmsp7SRRR/&quot;&gt;Dyrhólaey&lt;/a&gt; a kaňon &lt;a href=&quot;https://www.instagram.com/p/BGEJ4KSyRT3/&quot;&gt;Fjaðrárgljúfur&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Pobyt na Islandu jsme se rozhodli zakončit v hostelu KEX, kde se v době našeho pobytu, jako každé úterý, konal &lt;a href=&quot;https://www.instagram.com/p/BF06Iz7DAHq/&quot;&gt;jazzový koncert&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;K sepsání zážitků z Paříže se snad dostanu dříve, než je zapomenu.&lt;/p&gt;

&lt;p&gt;Další fotky z naší cesty najdeš na &lt;a href=&quot;https://www.instagram.com/explore/tags/lidaajoseftripmay2016/&quot;&gt;Instagramu&lt;/a&gt;.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>Island: část 1.</title>
   <link href="https://blog.rousek.name/2016/05/24/rejkjavik/"/>
   <updated>2016-05-24T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2016/05/24/rejkjavik</id>
   <content type="html">&lt;p&gt;Island mě překvapil na několika frontách. Jak odlišně, čistě a nádherně působí zdejší příroda, jak malá jsou města a vesnice mimo Rejkjavík.&lt;/p&gt;

&lt;p&gt;Hlavním lákadlem Rejkjavíku zpětně považuji místní bazén Sundhöll Rejkjavík. Když jsem vynechal saunu ve Finsku, nemohl jsem si nechat ujít “vířivku” na terase s vodou o teplotě 39˚C a 42˚C.&lt;/p&gt;

&lt;p&gt;Další na pořadu zájmu byly ryby. Chtěli jsme navštívit místní bleší trh, kde prodávají i potraviny. Zrovna ale změnili otevírací dobu, místo soboty a neděle otevírají v sobotu a v pondělí. Vzali jsme tedy za vděk pstruhem ze supermarketu, na čerstvosti to ale neubralo.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/island-roasters.jpg&quot; alt=&quot;Reykjavík Roasters&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nemohli jsme vynechat ani kavárny. Mimo klasických kaváren Reykjavík Roasters a Kaffitár nás oslovil řetězec knihkupectví s kavárnou
Te &amp;amp; Kaffi. Protože je na Islandu teplo, došlo i na zmrzlinu. A když zmrzlinu na tak neobvyklém místě jako je Island, vybral jsem si neobvyklou příchuť - lékořici.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/island-icecream.jpg&quot; alt=&quot;Lékořicová zmrzlina&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Po třech dnech nastal čas konečně vypadnout do divočiny. Vyzbrojeni Suzuki Swift, jehož autorádio překvapivě umí iPod protokol, jsme se vydali směr Gulfoss na první a nejturističtější den našeho road tripu. Naše šnečí tempo odpovídalo snaze ušetřit a úžasu z okolní krajiny. &lt;a href=&quot;https://www.instagram.com/p/BFlYHuqyRdZ/&quot;&gt;Þingvellir&lt;/a&gt;, Geysir i &lt;a href=&quot;https://www.instagram.com/p/BFjyZAOSRTP/&quot;&gt;Gulfoss&lt;/a&gt; jsou nádherná místa plná historie, která stojí za návštěvu i přes nehezké množství turistů. Z druhého dne vypíchnu visutý most přes řeku Ölfusá u vesnice Laugarás, &lt;a href=&quot;https://www.instagram.com/p/BFqfHxPyRWg/&quot;&gt;malebný kopeček s ovcemi&lt;/a&gt; a domem v pozadí kousek od Laugarvatn, vodopád &lt;a href=&quot;https://www.instagram.com/p/BFmxC15SRVC/&quot;&gt;Uriðafoss&lt;/a&gt; a vrak vojenského letadla na pláži &lt;a href=&quot;https://www.instagram.com/p/BFoH1_IyRcp/&quot;&gt;Sólheimasandur&lt;/a&gt;.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/island-most.jpg&quot; alt=&quot;Vysutý most&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;To už jsme se ale začali těšit na offroad autobus, který nás zaveze do Þórsmörk.&lt;/p&gt;

&lt;p&gt;Další fotky z naší cesty najdeš na &lt;a href=&quot;https://www.instagram.com/explore/tags/lidaajoseftripmay2016/&quot;&gt;Instagramu&lt;/a&gt;.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>Bristol</title>
   <link href="https://blog.rousek.name/2016/05/18/bristol/"/>
   <updated>2016-05-18T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2016/05/18/bristol</id>
   <content type="html">&lt;p&gt;Bristol. Naše přestupní stanice na Island. Jediné, co jsem znal předem byl Banksy a Bath. Nakonec na Bath ani nedošlo, Bristol nás zabavil víc než dost.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/bristol-debenhams.jpg&quot; alt=&quot;Clifton Suspension Bridge&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;AirBnb nás zavedlo do Eustonu, což je přistěhovalecká čtvrť, která začala lákat různé volnomyšlenkáře. U jedněch jsme bydleli. Moc často nepotkávám lidi, kteří poslouchají BBC a večer si(nebo dítěti) hodinu zpívají. Hlavním zdrojem zásob se stal obchod zaměrující se na Střední Východ a Asii s jejich instantním indickým jídlem. Místním zdrojem kávy je &lt;a href=&quot;http://12easton.com&quot;&gt;No. 12 Easton&lt;/a&gt; kavárna a obchod s delikatesami, pokud zabloudíte do této čtvrti, určitě doporučuju.&lt;/p&gt;

&lt;p&gt;Druhý den nás krásné počasí vyhnalo do parku, který, jak jsme později zjistili, je hned vedle hlavní obchodní ulice. Ta ukrývala &lt;a href=&quot;http://www.bristolcolab.com&quot;&gt;Co-LAB&lt;/a&gt;, designový obchůdek s kavárnou, který bych nejdradši celý vykoupil. Dále následovalo Arnolfini, centrum současného umění, moje oblíbená zastávka v každém městě. Jeho poloha u řeky a kavárna vybízí k diskuzím o umění na náplavce před galerií.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/bristol-clifton.jpg&quot; alt=&quot;Clifton Suspension Bridge&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Poslední den měl na programu nejznámější a pro mě nejděsivější most ve městě. Clifton Suspension Bridge přemosťuje rokli Avon a je vysoký přibližně 90 metrů. I když je to hodně turistické místo, jeho návštěva stojí za to. Nedaleko je &lt;a href=&quot;http://www.papersmiths.co.uk&quot;&gt;Papersmiths&lt;/a&gt;, pořádně hip papírnictví, kde jsem ukořistil mapku &lt;a href=&quot;http://shop.herblester.com/products/around-reykjavik&quot;&gt;Around Reykjavik&lt;/a&gt;, která mě hodně pomohla.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/bristol-arts-house.jpg&quot; alt=&quot;The Arts House&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Naprosto nejzajímavějším místem je ale Stokes Croft. Graffiti, kavárny a plno malých obchodů. Hamilton House je legální Klinika, místo, kam si člověk může zajít na pivo, zacvičit jógu, vařit. The Arts House nás oslovil výborným obědem, hrachovou polévkou a panini.&lt;/p&gt;

&lt;p&gt;Přístě si musím dát na kole trasu Bristol - Bath, prý je postavena na trase staré vlakové trati.&lt;/p&gt;

&lt;p&gt;Další fotky z naší cesty najdeš na &lt;a href=&quot;https://www.instagram.com/explore/tags/lidaajoseftripmay2016/&quot;&gt;Instagramu&lt;/a&gt;.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>Irsko: země, kde není nadávkou jít do hospody</title>
   <link href="https://blog.rousek.name/2016/05/14/irsko/"/>
   <updated>2016-05-14T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2016/05/14/irsko</id>
   <content type="html">&lt;p&gt;Právě sedíme v našem dočasném pokoji u Bristolských Airbnb hostitelů. Je tedy čas napsat o mých pocitech z Irska.&lt;/p&gt;

&lt;p&gt;První na pořadu dne nebo spíše večera v Irsku byla samozřejmě hospoda. Zatáhl nás tam můj spolužák ze střední školy, který pracuje v Dublinu.&lt;/p&gt;

&lt;p&gt;Tam začala moje cesta za oblíbeným pivem, vybírat si mezi 10 - 20 pivy není činnost na kterou bych byl zvyklý. Úspěch se dostavil až za dva dny, kdy jsem náhodou objevil Smithwick’s Pale Ale. V ten samý den, kdy jsem poprvé řídíl Audi A3 a ještě k tomu vlevo, se objev prvního oblíbeného piva opravdu hodil.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;img src=&quot;/public/irsko-audi.jpg&quot; alt=&quot;Řídím vlevo!&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Zmíněné auto bylo prostředkem, jak poznat opravdové Irsko, konkrétně Wicklow Mountains. I když jsme z Irska poznali jen malou část, těch pár míst za to stálo. Každou chvíli jsme viděli něco, co nás přesvědčilo zastavit a prohlednout si okolí. Ať už most přes řeku &lt;a href=&quot;https://www.instagram.com/p/BFTZKRDyRRH/&quot;&gt;Glasnagollam&lt;/a&gt;, vyhlídka na horu Camaderry, vodopád &lt;a href=&quot;https://www.instagram.com/p/BFPK6YbyRQQ/&quot;&gt;Powerscourt&lt;/a&gt; a plno dalších bezejmených zastávek, všechny za to stály. Turistika v Irsku má ale i zábavné stránky. To když k vodopádu Powerscourt dorazíme v 7 hodin a zjistíme, že  otevírají až v 9:30. Naštěstí mapy od Seznamu nabízely naději existující alternativní cesty. Cesta opravdu existuje, jenže zahrnuje přechod řeky, převážně suchou cestou, skákáním po kamenech. Odměna v podobě vodopádu jen pro nás byla ale víc než přiměřená.&lt;/p&gt;

&lt;p&gt;Bez kaváren by to samozřejmě nebylo žádné cestování. &lt;a href=&quot;https://www.instagram.com/p/BFQ9yNPyRek/&quot;&gt;Proper Order Coffee Co.&lt;/a&gt; má snad nejlepší brownies jaké jsem kdy jedl. V Kaph mají skvělé espresso-based nápoje. Vice Coffee Inc. je kavárna se skvělým filtrem přímo v hudebním klubu Wigwam. My jsme tady ale byli těsně před odletem na rychlém posilnění okolo oběda. Za hudbou jsme byli jinde.&lt;/p&gt;

&lt;p class=&quot;post__image-center post__image-no-bottom-margin&quot;&gt;&lt;img src=&quot;/public/irsko-vice.jpg&quot; alt=&quot;Vice Coffee Inc.&quot; class=&quot;post__image&quot; /&gt;&lt;/p&gt;
&lt;p class=&quot;post__image-center&quot;&gt;Filtr ve Vice Coffee Inc.&lt;/p&gt;

&lt;p&gt;Díky P.S. I Love You jsme si vybrali koncert ve Whelan’s. Klub s krbem a příjemným barmanem. Zaujal nás kanadský písničkář s kapelou &lt;a href=&quot;https://theburninghell.bandcamp.com/album/public-library&quot;&gt;The Burning Hell&lt;/a&gt;, měli za předskokana &lt;a href=&quot;https://soundcloud.com/my-tribe-your-tribe&quot;&gt;My Tribe Your Tribe&lt;/a&gt;, kteří nám poskytnuli dávku ostrovního alternative rocku.&lt;/p&gt;

&lt;p&gt;Irská příroda si zaslouží určitě víc času, teď mě ale čeká Clifton Suspension Bridge, děsivě vysoký most.&lt;/p&gt;

&lt;p&gt;Další fotky z naší cesty najdeš na &lt;a href=&quot;https://www.instagram.com/explore/tags/lidaajoseftripmay2016/&quot;&gt;Instagramu&lt;/a&gt;.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>Recommending Instagram photos using scikit-learn</title>
   <link href="https://blog.rousek.name/2016/01/13/recommending-instagram-photos-using-scikit-learn/"/>
   <updated>2016-01-13T00:00:00-06:00</updated>
   <id>https://blog.rousek.name/2016/01/13/recommending-instagram-photos-using-scikit-learn</id>
   <content type="html">&lt;p&gt;I recently published first working version of my latest project. It is an Instagram newsletter based on pretty basic Machine Learning method. I called it &lt;a href=&quot;http://socialist.rousek.name&quot;&gt;socialist&lt;/a&gt;. Feel free to try it out I would love to hear your feedback.&lt;/p&gt;

&lt;p&gt;There were multiple motivations behind this project. I had strong urge to start Django project, create something related to Instagram, hopefully do some Machine Learning along the way, use git properly and finally use the most mainstream (maybe only in my bubble) tools specifically Github, Travis and Heroku. All this led to simple outcome. Start project as open source.&lt;/p&gt;

&lt;p&gt;“Magic” hidden behind is summarized in two Jupyter notebooks. First one selects recent photos similar to what user has liked. Instagram doesn’t allow much in its API, so I combined two queries and some nice images appeared.&lt;/p&gt;

&lt;p&gt;Except sometimes totally unrelated image sneaked in. So I started looking for some primitive way to analyze distance between two users. It took me several weeks of occasional work to to find example I could use. I ended up with a great article &lt;a href=&quot;https://www.de.dariah.eu/tatom/working_with_text.html&quot;&gt;Text Analysis with Topic Models&lt;/a&gt;. Yes, only text. My premise was that for basic distinction text analysis should be enough. And luckily it was.&lt;/p&gt;

&lt;p&gt;To filter out posts from unrelated users I used following process. Download latest 200 photos for each users and throw them to &lt;a href=&quot;http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html&quot;&gt;CountVectorizer&lt;/a&gt; to create a document-term matrix. Then use the matrix to filter media too distant from users.&lt;/p&gt;

&lt;p&gt;You can find both notebooks and project itself on Github.com:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/stlk/socialist&quot;&gt;socialist&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/stlk/socialist/blob/master/jupyter/photo_recomendation.ipynb&quot;&gt;photo recommendation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/stlk/datatalks/blob/master/instagram/mds.ipynb&quot;&gt;working with document-term matrix&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>Adventure with matplotlib, virtualenv and MacOS</title>
   <link href="https://blog.rousek.name/2015/11/29/adventure-with-matplotlib-virtualenv-and-macosx/"/>
   <updated>2015-11-29T00:00:00-06:00</updated>
   <id>https://blog.rousek.name/2015/11/29/adventure-with-matplotlib-virtualenv-and-macosx</id>
   <content type="html">&lt;p&gt;Recently I’ve developed passion for machine learning. Which includes many hours of fun with various modeling and plotting libraries.&lt;/p&gt;

&lt;p&gt;Yesterday I was playing around with &lt;a href=&quot;http://scikit-learn.org/stable/modules/generated/sklearn.manifold.MDS.html&quot;&gt;Multidimensional scaling&lt;/a&gt; in jupyter notebook. But when I tried to render a chart it just didn’t work.
Engine got stuck and I had to restart it. At first I though that the rendering is too complicated, but even simple example didn’t work.&lt;/p&gt;

&lt;p&gt;Problem was as I later discovered caused by a &lt;a href=&quot;https://github.com/pypa/virtualenv/issues/54&quot;&gt;bug&lt;/a&gt; in virtualenv. I managed to get it working using workaround described on &lt;a href=&quot;http://matplotlib.org/devdocs/faq/virtualenv_faq.html#osx&quot;&gt;matplotlib’s FAQ&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;First install python and create virtualenv.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;brew &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;--framework&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# install python 2.7 framework build&lt;/span&gt;
virtualenv &lt;span class=&quot;nb&quot;&gt;env&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# create virtualenv&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Then create bash script called &lt;code class=&quot;highlighter-rouge&quot;&gt;frameworkpython&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;bin&lt;/code&gt; folder of your environment, in my case it’s &lt;code class=&quot;highlighter-rouge&quot;&gt;env/bin/frameworkpython&lt;/code&gt; with following content.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# what real Python executable to use&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;PYVER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2.7
&lt;span class=&quot;nv&quot;&gt;PATHTOPYTHON&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/bin/
&lt;span class=&quot;nv&quot;&gt;PYTHON&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PATHTOPYTHON&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;python&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PYVER&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# find the root of the virtualenv, it should be the parent of the dir this script is in&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ENV&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PYTHON&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;import os; print os.path.abspath(os.path.join(os.path.dirname(&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;), '..'))&quot;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# now run Python with the virtualenv set as Python's HOME&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PYTHONHOME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ENV&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$PYTHON&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Make the scipt executable and install libraries.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x &lt;span class=&quot;nb&quot;&gt;env&lt;/span&gt;/bin/frameworkpython &lt;span class=&quot;c&quot;&gt;# make it executable&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;source env&lt;/span&gt;/bin/activate &lt;span class=&quot;c&quot;&gt;# activate environment&lt;/span&gt;
pip &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;matplotlib jupyter notebook &lt;span class=&quot;c&quot;&gt;# install matplotlib and jupyter notebook&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Only one problem was ahed of me. How to start the notebook from this script. It was pretty simple in the end &lt;code class=&quot;highlighter-rouge&quot;&gt;frameworkpython env/bin/jupyter-notebook&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;You can use this code to test it. Don’t forget to use &lt;code class=&quot;highlighter-rouge&quot;&gt;%matplotlib inline&lt;/code&gt; in your notebook to prevent window popping up.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matplotlib&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inline&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;2.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;grid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I hope this article will save you some hours of your life I spent with this. You can see the result on my &lt;a href=&quot;https://github.com/stlk/datatalks/blob/master/instagram/mds.ipynb&quot;&gt;github&lt;/a&gt;.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Výlet do Finska</title>
   <link href="https://blog.rousek.name/2015/01/04/vylet-do-finska/"/>
   <updated>2015-01-04T00:00:00-06:00</updated>
   <id>https://blog.rousek.name/2015/01/04/vylet-do-finska</id>
   <content type="html">&lt;p&gt;Na konci října jsem si udělal výlet do Finska. Ani nevím proč, rukavice nosím hned jak teplota klesne pod 10°C a válení se na slunci je mojí oblíbenou aktivitou. Nejspíš kvůli jazyku, který mě vždy přihoval. Původní úvahy začínaly na 14 dnech, nakonec jsem skončil na sedmi. A to je, opravdu málo. Tři dny v Helsinkách, přibližně jeden den ve městě Jyvaskyla a dva dny v Oulu.&lt;/p&gt;

&lt;p&gt;Rozhodl jsem se experimentovat a vyzkoušet něco jiného než hotely. Rozhodoval jsem se mezi AirBnb a Couchsurfingem. Pro AirBnb jsem se nakonec rozhodl, protože jsem chtěl mít více času na práci. Couchsurfing býva časově náročnější než AirBnb, protože hostitel je hostovi více k dispozici a je slušné na oplátku nakoupit a něco uvařit. Ale zkuste poznat tři města za sedm dní a pracovat při tom.
Od nákupu letenky mě neodradil ani čas příletu plánovaný po půlnoci. Trochu mě uklidnil fakt, že v Helsinkách se z letiště do centra dostanu MHD v jakoukoli dobu.&lt;/p&gt;

&lt;p&gt;První den ve Finsku jsem si chtěl užít. Nikam nespěchat. Mrazivé počasí mě ale donutilo hledat nejbližsí kavárnu, kde bych mohl posnídat a chvilí “pracovat”. Kavárna, kterou jsem našel, byla ta nejlepší kompenzace na spánkový deficit. Stylová dekorace, milá obsluha, výborná káva.&lt;/p&gt;

&lt;blockquote class=&quot;instagram-media&quot; data-instgrm-version=&quot;6&quot; style=&quot; background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 2rem auto; max-width:400px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);&quot;&gt;&lt;div style=&quot;padding:8px;&quot;&gt; &lt;div style=&quot; background:#F8F8F8; line-height:0; margin-top:40px; padding:50% 0; text-align:center; width:100%;&quot;&gt; &lt;div style=&quot; background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAAGFBMVEUiIiI9PT0eHh4gIB4hIBkcHBwcHBwcHBydr+JQAAAACHRSTlMABA4YHyQsM5jtaMwAAADfSURBVDjL7ZVBEgMhCAQBAf//42xcNbpAqakcM0ftUmFAAIBE81IqBJdS3lS6zs3bIpB9WED3YYXFPmHRfT8sgyrCP1x8uEUxLMzNWElFOYCV6mHWWwMzdPEKHlhLw7NWJqkHc4uIZphavDzA2JPzUDsBZziNae2S6owH8xPmX8G7zzgKEOPUoYHvGz1TBCxMkd3kwNVbU0gKHkx+iZILf77IofhrY1nYFnB/lQPb79drWOyJVa/DAvg9B/rLB4cC+Nqgdz/TvBbBnr6GBReqn/nRmDgaQEej7WhonozjF+Y2I/fZou/qAAAAAElFTkSuQmCC); display:block; height:44px; margin:0 auto -44px; position:relative; top:-22px; width:44px;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;p style=&quot; color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; line-height:17px; margin-bottom:0; margin-top:8px; overflow:hidden; padding:8px 0 7px; text-align:center; text-overflow:ellipsis; white-space:nowrap;&quot;&gt;&lt;a href=&quot;https://www.instagram.com/p/uQHBb8yRVI/&quot; style=&quot; color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none;&quot; target=&quot;_blank&quot;&gt;A photo posted by Josef Rousek (@josef.rousek)&lt;/a&gt; on &lt;time style=&quot; font-family:Arial,sans-serif; font-size:14px; line-height:17px;&quot; datetime=&quot;2014-10-17T11:20:22+00:00&quot;&gt;Oct 17, 2014 at 4:20am PDT&lt;/time&gt;&lt;/p&gt;&lt;/div&gt;&lt;/blockquote&gt;
&lt;script async=&quot;&quot; defer=&quot;&quot; src=&quot;//platform.instagram.com/en_US/embeds.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;A co dělat večer ve městě kde nikoho neznám? Přece vyrazit na couchsurfing sraz, který se zrovna v ten den konal. Kde jinde by člověk mohl potkat cestovatele z Chille, který tři roky prozkoumává Evropu a strávil zimu v jedné vesnici v Rusku.&lt;/p&gt;

&lt;p&gt;Další den byla na programu diskuze performance umělců o rodném jazyce a výstava poukazující na fakt, že fotografie se stala součástí komunikace. Tou dobou jsem měl Helsinky už dobře zmapované. Hlavně kavárny, kde jsem se schovával před zimou.&lt;/p&gt;

&lt;p&gt;To se ale začal blížit čas cesty do středního Finska, kde jsem chtěl prozkoumat přírodu. Jenže celý den pršelo. Výsledkem návštěvy města bylo tedy jen ochutnání skvěle připravené ryby Arctic Char a objev drinku Karpaloinen. A pak hurá do Oulu, kde už na mě čekal bývalý spoluhráč ze hry World of Warcraft. Bylo to moje první setkaní se zahraničním hráčem. Probrali jsme, co víme o našich společných známých a rozebrali jsme nový datadisk.&lt;/p&gt;

&lt;p&gt;Jako svoje další hostitele jsem si vybral americko-finskou rodinu bydlící v útulném domě z roku 1920. Nad šálkem čaje jsme zjišťovali kdo jsme a probrali, co je možné ve městě vidět a jaké restaurace stojí za to navštívit. Na základě jejich doporučení jsem se vypravil k nedaleké řece, kde zrovna místní rybařili s pomocí malé sítě na dlouhém podběráku.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;a href=&quot;https://www.flickr.com/photos/stalker_cz/15432450050&quot; title=&quot;Rybáři v Oulu&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://farm6.staticflickr.com/5615/15432450050_f196ba40f8_n.jpg&quot; width=&quot;240&quot; height=&quot;320&quot; alt=&quot;Fisherman&quot; class=&quot;post__image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Když jsem vymýšlel program na poslední den v Oulu, napadlo mě využít společnosti nějakého couchsurfera. Napsal jsem několika lidem a ozvala se studentka z Číny, která zde momentálně studuje a má v plánu navštívit Prahu. Vylovil jsem tedy pár svých fotek a doporučil místa na která by tedy neměla zapomenout. Ona mi na oplátku pověděla mi o svých netradičních cestách, kdy se s kamarádkou vydaly stopem do Norského města Tromso. Cesta trvala přibližně 20 hodin a na místě se jim po příjezdu naskytlo velmi vřelého přivítání.&lt;/p&gt;

&lt;p&gt;Mým posledním nemalým dobrodružstvím bylo cestování nočním vlakem zpět do Helsinek. Protože cesta měla trvat 9 hodin, připlatil jsem za pohodlí v &lt;a href=&quot;https://www.flickr.com/photos/stalker_cz/15592334781/in/set-72157646465589693/&quot; title=&quot;Odkaz na Flickr&quot;&gt;lůžkovém kupé&lt;/a&gt;. Netrpělivě jsem čekal koho budu mít za spolucestujícího. Přálo mi štěstí a mým spolucestujícím byl starší pán, který k mé velké úlevě uměl anglicky. Probrali jsme skoro vše. Od vnímaní Ruska až po jeho důchodovou zálibu. Na stará kolena totiž absolvoval truhlářský kurz a svým dřevem tedy nejen topí, ale vyrábí i velmi pěkný nábytek. Do Helsinek jsem dorazil krátce po šesté hodině, díky věrnému průvodci Foursquare jsem našel kavárnu otevírající v sedm a vydal se dobýt energii.&lt;/p&gt;

&lt;p&gt;Celý týden byl natolik intenzivní a plný kontaktu s lidmi, že už jsem se těšil na svoji postel. Jen ještě koupit hrnek s Mumínky a vyrazit na letiště.&lt;/p&gt;

&lt;p&gt;Na &lt;a href=&quot;https://www.flickr.com/photos/stalker_cz/sets/72157646465589693/&quot; title=&quot;Odkaz na Flickr&quot;&gt;Flickru&lt;/a&gt; se můžete podívat na další &lt;a href=&quot;https://www.flickr.com/photos/stalker_cz/sets/72157646465589693/&quot; title=&quot;Odkaz na Flickr&quot;&gt;fotky&lt;/a&gt;.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>DigiSpark talking with .NET</title>
   <link href="https://blog.rousek.name/2013/12/31/digispark-talking-with-dotnet/"/>
   <updated>2013-12-31T00:00:00-06:00</updated>
   <id>https://blog.rousek.name/2013/12/31/digispark-talking-with-dotnet</id>
   <content type="html">&lt;p&gt;With black Friday sales I decided to buy few DigiSparks to try them out and maybe spark some interest in electronics in my brother. Designer of the board did very good job, overall USB experience feels smooth and is easy to understand.&lt;/p&gt;

&lt;p&gt;After some poking around I decided to try USB communication with C# on computer side. DigiSpark has DigiUSB library which is basically replacement of serial with much nicer handling of situations when disconnecting and connecting DigiSpark. I found working solution on DigiStump’s official forum so all credit for porting library to .NET goes to SmeeAgain.&lt;/p&gt;

&lt;p&gt;Windows app is pretty simple. It waits for key to be pressed. If it’s “O” 1 is sent otherwise 0 is sent.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-cpp&quot; data-lang=&quot;cpp&quot;&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;KeyAvailable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// If the key was pressed&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReadKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ConsoleKey&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;O&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// If it was O send 1 else 0&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;digiSpark&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WriteBytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Print any character that we receive.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-cpp&quot; data-lang=&quot;cpp&quot;&gt;&lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;digiSpark&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReadByte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Encoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Default&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GetString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Application can detect when device is connected or disconnected using event &lt;code class=&quot;highlighter-rouge&quot;&gt;ArduinoUsbDeviceChangeNotifier&lt;/code&gt;. There is one thing we need to be aware of. In order to receive events in console application we need to call &lt;code class=&quot;highlighter-rouge&quot;&gt;Application.DoEvents();&lt;/code&gt; in each cycle. Because class &lt;code class=&quot;highlighter-rouge&quot;&gt;Application&lt;/code&gt; is in namespace &lt;code class=&quot;highlighter-rouge&quot;&gt;System.Windows.Forms&lt;/code&gt; we need to reference it.&lt;/p&gt;

&lt;p&gt;There is nothing special on DigiSpark side too. We will control onboard LED. I’ve used breathing LED just to make it look nice. Sketch listens for incoming bytes, if its “1” &lt;code class=&quot;highlighter-rouge&quot;&gt;breathing&lt;/code&gt; is set to true. In both cases we send LED’s status.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-cpp&quot; data-lang=&quot;cpp&quot;&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DigiUSB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;breathing&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DigiUSB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;breathing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;analogWrite&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;breathing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;DigiUSB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;DigiUSB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;source-code&quot;&gt;Source code&lt;/h2&gt;
&lt;p&gt;Full source code is available on &lt;a href=&quot;https://github.com/stlk/DigiSparkDotNet&quot; title=&quot;Link to GitHub.com&quot;&gt;GitHub.com&lt;/a&gt;.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>Using ATTiny2313 as gateway between DS18B20 and Netduino</title>
   <link href="https://blog.rousek.name/2013/06/13/using-attiny2313-as-gateway-between-ds18b20-and-netduino/"/>
   <updated>2013-06-13T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2013/06/13/using-attiny2313-as-gateway-between-ds18b20-and-netduino</id>
   <content type="html">&lt;p&gt;For some time I was happy user of &lt;a href=&quot;http://forums.netduino.com/index.php?/topic/230-onewire-alpha/&quot; title=&quot;Link to Netduino.com forums&quot;&gt;Stanislav “CW2” Šimíček’s&lt;/a&gt; modified firmware which brought OneWire capability to Netduino, but new version(4.2) of .NET MicroFramework came and I realized there are other possibilities. More specifically I realized that this is good opportunity to make something useful with C on Atmel chips.&lt;/p&gt;

&lt;p&gt;I decided to build device which reads temperature and sends it back to Netduino using UART. For this task I’ve chosen ATTiny2313 which was cheapest chip with UART at the time of buying.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.flickr.com/photos/stalker_cz/9033527511/&quot; title=&quot;ATTiny2313 by JosefRousek, on Flickr&quot;&gt;&lt;img src=&quot;http://farm4.staticflickr.com/3738/9033527511_cb41ab499e_n.jpg&quot; width=&quot;320&quot; height=&quot;218&quot; alt=&quot;ATTiny2313&quot; class=&quot;right&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;As you can see the circuit is terribly simple. I’ve used external crystal because I couldn’t make UART work with internal one. But there might be something else which was causing my problems.&lt;/p&gt;

&lt;p&gt;The program is a bit more interesting but its fairly simple. It waits for character “t” followed by “1” or “2” and replies with it’s identificator(t1 or t2) followed by LSB and MSB of temperature. I then convert temperature to float using following statement.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;float temp = ((short)((MSB &amp;lt;&amp;lt; 8) | LSB)) / 16F;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;I’m using minimal implementation of OneWire protocol originally written by &lt;a href=&quot;http://walda.starhill.org/elektronika-avr-gcc-stripky.html&quot; title=&quot;Walda's website&quot;&gt;Walda&lt;/a&gt; with added CRC verification. This implementation requires you to use separate pin for each sensor. But it isn’t an issue for me. Almost each line of source code is commented so I will rather focus on describing my configuration.&lt;/p&gt;

&lt;p&gt;My ATTiny is running on 16MHz, this is set on beginning of both &lt;em&gt;makefile&lt;/em&gt; and &lt;em&gt;main.c&lt;/em&gt;. Another noteworthy thing is programmer options described on line &lt;a href=&quot;https://github.com/stlk/avr/blob/master/attiny2313_ds18b20/makefile#L270&quot; title=&quot;Link to line 270 of makefile on GitHub.com&quot;&gt;270 of makefile&lt;/a&gt;. I’m using Arduino as programmer which is disguised as stk500v1, it is connected to port COM4 and programming speed is 19200bps.&lt;/p&gt;

&lt;h3 id=&quot;netduino-side&quot;&gt;Netduino side&lt;/h3&gt;

&lt;p&gt;Here is my overly complicated way of handling UART communication on .NETMF where temperature is converted to readable format on line 64.&lt;/p&gt;

&lt;script src=&quot;https://gist.github.com/stlk/5791735.js&quot;&gt;&lt;/script&gt;

&lt;h3 id=&quot;source-code&quot;&gt;Source code&lt;/h3&gt;

&lt;p&gt;Full source code is available on &lt;a href=&quot;https://github.com/stlk/avr/blob/master/attiny2313_ds18b20&quot; title=&quot;Link to GitHub.com&quot;&gt;GitHub.com&lt;/a&gt;. Source code is licenced under &lt;a href=&quot;http://creativecommons.org/licenses/by/3.0/&quot;&gt;CC BY 3.0&lt;/a&gt;.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>Injecting dependecies into Web API Action Filters</title>
   <link href="https://blog.rousek.name/2012/09/09/injecting-dependecies-into-web-api-action-filters/"/>
   <updated>2012-09-09T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2012/09/09/injecting-dependecies-into-web-api-action-filters</id>
   <content type="html">&lt;p&gt;When I was working with ASP.NET Web API I needed to inject dependencies to ActionFilters using Ninject. This is solved by &lt;a href=&quot;https://github.com/azzlack/Ninject.Web.WebApi&quot; title=&quot;Link to GitHub project&quot;&gt;Ninject.Web.WebApi&lt;/a&gt;, but I had some stability issues with this library. When I started to dig a little deeper I found that in fact I’m using only one class from this library. Which is &lt;a href=&quot;https://github.com/azzlack/Ninject.Web.WebApi/blob/master/src/Ninject.Web.WebApi/Filter/DefaultFilterProvider.cs&quot;&gt;DefaultFilterProvider&lt;/a&gt; this class steps into play before filter methods are executed and injects dependencies into it.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;public IEnumerable&amp;lt;FilterInfo&amp;gt; GetFilters(HttpConfiguration configuration,
                                        HttpActionDescriptor actionDescriptor)
{
    var filters = this.filterProviders.SelectMany(fp =&amp;gt; 
            fp.GetFilters(configuration, actionDescriptor)).ToList();
    
    foreach (var filter in filters)
    {
        this.kernel.Inject(filter.Instance);
    }
    
    return filters;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And how do we tell the WEB API that we want to use this provider? First we need to register our provider to GlobalConfiguration services and then remove the default one.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;var providers = GlobalConfiguration.Configuration.Services.GetFilterProviders().ToList();
GlobalConfiguration.Configuration.Services.Add(typeof (IFilterProvider),
                                               new DefaultFilterProvider(ninjectKernel, providers));
            
var defaultprovider = providers.First(i =&amp;gt; i is ActionDescriptorFilterProvider);
GlobalConfiguration.Configuration.Services.Remove(typeof(IFilterProvider), defaultprovider);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Example is available on &lt;a href=&quot;https://github.com/stlk/WebApiDependencyInjectionWithNinject&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>Wireless RGB lamp - The controller</title>
   <link href="https://blog.rousek.name/2012/06/18/wireless-rgb-lamp-the-controller/"/>
   <updated>2012-06-18T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2012/06/18/wireless-rgb-lamp-the-controller</id>
   <content type="html">&lt;p&gt;In this part I will show you how to control &lt;a href=&quot;http://rousek.name/blog/wireless-rgb-lamp&quot; title=&quot;Link to my previous post&quot;&gt;RGB lamp&lt;/a&gt; using Netduino. The basics such as &lt;a href=&quot;http://rousek.name/blog/control-lights-remotely-using-xbee-and-netduino&quot; title=&quot;Link to another blog post&quot;&gt;wiring XBee to Netduino and XBee setup&lt;/a&gt; are described in my previous article, so I will highlight only most interesting bits.&lt;/p&gt;

&lt;p&gt;Method &lt;code class=&quot;highlighter-rouge&quot;&gt;RequestReceived&lt;/code&gt; handles incoming HTTP requests and decides which command send to XBee.&lt;/p&gt;

&lt;p&gt;If URL is (your XBee’s IP)/fade/1000 where 1000 is delay in milliseconds, following code is executed. Because highest number we can squeeze to one byte is 255 we need to use two bytes to achieve more suitable range 0 - 65535. We then need to split that number into two bytes as shown below.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;short fadeDelay = short.Parse(param[2]); // param[2] is delay in milliseconds
_xBee.SendData(0x0013A200407A26AA, 0xFFFE,
                new byte[]
                    {
                        20,
                        (byte) (fadeDelay &amp;gt;&amp;gt; 8),
                        (byte) (fadeDelay &amp;amp; 0x00FF)
                    }, null);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Following two commands are simple. Just parse number and send it.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;case &quot;mode&quot;:
    if (param.Length == 3)
    {
        byte fadeMode = byte.Parse(param[2]);
        _xBee.SendData(0x0013A200407A26AA, 0xFFFE, new byte[] { 21, fadeMode }, null);
    }
    break;
case &quot;color&quot;:
    if (param.Length == 3)
    {
        byte color = byte.Parse(param[2]);
        _xBee.SendData(0x0013A200407A26AA, 0xFFFE, new byte[] { 22, color }, null);
    }
    break;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Command &lt;em&gt;colorx&lt;/em&gt; takes 3 arguments. So URL will look like this (your XBee’s IP)/colorx/(0-255 red)/(0-255 green)/(0-255 blue)&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;byte colorR = byte.Parse(param[2]);
byte colorG = byte.Parse(param[3]);
byte colorB = byte.Parse(param[4]);
_xBee.SendData(0x0013A200407A26AA, 0xFFFE, new byte[] { 23, colorR, colorG, colorB }, null);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Last command sends just one byte which requests current settings. When it’s received method &lt;code class=&quot;highlighter-rouge&quot;&gt;XBeeFrameReceived&lt;/code&gt; gets called. You can put breakpoint into the empty &lt;code class=&quot;highlighter-rouge&quot;&gt;case&lt;/code&gt; statement or print incoming data. Format is described in table below.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;_xBee.SendData(0x0013A200407A26AA, 0xFFFE, new byte[] { 24 }, null);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;commands&quot;&gt;Commands&lt;/h3&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;&lt;th&gt;ID&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Data&lt;/th&gt;&lt;th&gt;Description&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;Fade delay&lt;/td&gt;
&lt;td&gt;high byte, low byte&lt;/td&gt;
&lt;td&gt;0 - 65535 milliseconds&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;21&lt;/td&gt;
&lt;td&gt;Mode&lt;/td&gt;
&lt;td&gt;mode id&lt;/td&gt;
&lt;td&gt;0 - disabled, 1 - single color, 2 - fading, 3 - strobe&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;22&lt;/td&gt;
&lt;td&gt;Color&lt;/td&gt;
&lt;td&gt;color id&lt;/td&gt;
&lt;td&gt;0 - Red, 1 - Green, 2 - Blue, 3 - Yellow, 4 - Cyan, 5 - Orange, 6 - Magenta&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;23&lt;/td&gt;
&lt;td&gt;Color&lt;/td&gt;
&lt;td&gt;red byte, green byte, blue byte&lt;/td&gt;
&lt;td&gt;0 - 255 for each color&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;24&lt;/td&gt;
&lt;td&gt;Status&lt;/td&gt;
&lt;td colspan=&quot;2&quot;&gt;&lt;em&gt;returns&lt;/em&gt; current settings in format: 25, mode, [fade delay] high, low, [color] R, G, B&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;source-code&quot;&gt;Source code&lt;/h3&gt;

&lt;p&gt;Full source code is available on &lt;a href=&quot;https://github.com/stlk/RGBLampGateway&quot; title=&quot;Link to GitHub.com&quot;&gt;GitHub.com&lt;/a&gt;.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>Wireless RGB lamp</title>
   <link href="https://blog.rousek.name/2012/05/29/wireless-rgb-lamp/"/>
   <updated>2012-05-29T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2012/05/29/wireless-rgb-lamp</id>
   <content type="html">&lt;p&gt;For a long time I wanted to have a wirelessly controlled RGB light in my kitchen. This idea got more specific shape when I saw hacked IKEA dioder light where original PIC microcontroller was removed and ATTiny took its place. This wasn’t the one I ended up using, but I think it’s worth mentioning. I have decided to use &lt;a href=&quot;http://www.gme.cz/vykonove-led-nad-1w/l-lxhl-hprgb-p511-558/&quot; title=&quot;Link to Czech shop GM electronic&quot;&gt;5,1W RGB LED&lt;/a&gt; along with ATMega328P with Arduino bootloader and XBee for the wireless connectivity.&lt;/p&gt;

&lt;p class=&quot;post__image-center&quot;&gt;&lt;a href=&quot;http://www.flickr.com/photos/stalker_cz/7181211930/&quot; title=&quot;Link to Flickr&quot;&gt;&lt;img src=&quot;http://farm6.staticflickr.com/5348/7181211930_369958da68_n.jpg&quot; class=&quot;post__image&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Arduino is running on 3,3V so it can safely communicate with XBee which means the only special circuit needed is LED controller. Controller consists of three &lt;a href=&quot;http://www.gme.cz/bipolarni-tranzistory-npn/bd139-16-p211-010/&quot; title=&quot;Link to Czech shop GM electronic&quot;&gt;BD139-16&lt;/a&gt; transistors and three high power resistors. Base current is limited by 470 ohm resistors. Thing which scared me a bit when I was testing this circuit is that high power resistors were getting pretty hot. But values I measured were correct and yeah, it’s good idea to check datasheet. I found that high temperature is normal. There is another thing worth mentioning. Don’t forget to connect AVCC pin to VCC, because it is required when running on 3,3V with &lt;abbr title=&quot;Brown Out Detector&quot;&gt;BOD&lt;/abbr&gt; enabled. You will save yourself few hours wondering why the hell it doesn’t work on 3,3V.&lt;/p&gt;

&lt;p&gt;XBee I’m using is XBee Series 2 with API firmware, because it allows me to easily create mesh of devices. My current setup is XBee Controller connected to &lt;a href=&quot;http://www.flickr.com/photos/stalker_cz/6368627583/&quot; title=&quot;Link to Flickr&quot;&gt;Netduino Plus&lt;/a&gt; and two end devices. &lt;a href=&quot;http://www.flickr.com/photos/stalker_cz/7145245471/&quot; title=&quot;Link to Flickr&quot;&gt;Wireless LCD&lt;/a&gt; and RGB Lamp. Netduino serves as gateway to the internet (for temperature sensors) and LAN (for &lt;a href=&quot;http://rousek.name/blog/wireless-rgb-lamp-the-controller&quot; title=&quot;Link to my blog post&quot;&gt;controlling lamp&lt;/a&gt;). Netduino runs lightweight webserver and when request is received it sends ZigBee packet to the lamp. This way I can change mode by visiting &lt;em&gt;http://192.168.1.95/mode/mode_id&lt;/em&gt;. I can do the same on Wireless LCD so I don’t have to run to my PC every time I want to control the lamp. I will describe both ways in future posts.&lt;/p&gt;

&lt;p&gt;Firmware is pretty straightforward. It listens for commands, stores settings on EEPROM and fades the led. Commands are received in form of ZigBee Receive packet where first byte specifies command id and following bytes are different for each command. Commands are described in table below.&lt;/p&gt;

&lt;h3 id=&quot;commands&quot;&gt;Commands&lt;/h3&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;&lt;th&gt;ID&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Data&lt;/th&gt;&lt;th&gt;Description&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;20&lt;/td&gt;
&lt;td&gt;Fade delay&lt;/td&gt;
&lt;td&gt;high byte, low byte&lt;/td&gt;
&lt;td&gt;0 - 65535 milliseconds&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;21&lt;/td&gt;
&lt;td&gt;Mode&lt;/td&gt;
&lt;td&gt;mode id&lt;/td&gt;
&lt;td&gt;0 - disabled, 1 - single color, 2 - fading, 3 - strobe&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;22&lt;/td&gt;
&lt;td&gt;Color&lt;/td&gt;
&lt;td&gt;color id&lt;/td&gt;
&lt;td&gt;0 - Red, 1 - Green, 2 - Blue, 3 - Yellow, 4 - Cyan, 5 - Orange, 6 - Magenta&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;23&lt;/td&gt;
&lt;td&gt;Color&lt;/td&gt;
&lt;td&gt;red byte, green byte, blue byte&lt;/td&gt;
&lt;td&gt;0 - 255 for each color&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;24&lt;/td&gt;
&lt;td&gt;Status&lt;/td&gt;
&lt;td colspan=&quot;2&quot;&gt;&lt;em&gt;returns&lt;/em&gt; current settings in format: 25, mode, [fade delay] high, low, [color] R, G, B&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;schematic&quot;&gt;Schematic&lt;/h3&gt;

&lt;iframe width=&quot;600&quot; height=&quot;350&quot; frameborder=&quot;0&quot; src=&quot;http://c.circuitbee.com/build/r/schematic-embed.html?id=0000000249&quot;&gt;&lt;/iframe&gt;

&lt;h3 id=&quot;part-list&quot;&gt;Part list&lt;/h3&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;&lt;th&gt;ID&lt;/th&gt;&lt;th&gt;Description&lt;/th&gt;&lt;th&gt;Count&lt;/th&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;R4, R5, R6&lt;/td&gt;
&lt;td&gt;470Ω&lt;/td&gt;
&lt;td&gt;3x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;R2, E3&lt;/td&gt;
&lt;td&gt;4,7Ω&lt;/td&gt;
&lt;td&gt;2x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;R1&lt;/td&gt;
&lt;td&gt;8,2Ω&lt;/td&gt;
&lt;td&gt;1x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;T1, T2, T3&lt;/td&gt;
&lt;td&gt;BD139-16&lt;/td&gt;
&lt;td&gt;3x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;RES1&lt;/td&gt;
&lt;td&gt;Ceramic Resonator 16MHz&lt;/td&gt;
&lt;td&gt;1x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;D1, D2, D3&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;http://www.gme.cz/vykonove-led-nad-1w/l-lxhl-hprgb-p511-558/&quot; title=&quot;Link to Czech shop GM electronic&quot;&gt;L-LXHL-HPRGB&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;1x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IC1&lt;/td&gt;
&lt;td&gt;ATMega 328P&lt;/td&gt;
&lt;td&gt;1x&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;IC2&lt;/td&gt;
&lt;td&gt;XBee Series 2&lt;/td&gt;
&lt;td&gt;1x&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;source-code&quot;&gt;Source code&lt;/h3&gt;

&lt;p&gt;Source code is available on &lt;a href=&quot;https://github.com/stlk/Arduino/blob/master/stlk_lamp/stlk_lamp.ino&quot; title=&quot;Source code on Github&quot;&gt;Github&lt;/a&gt;.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>Control lights remotely using XBee and Netduino</title>
   <link href="https://blog.rousek.name/2012/01/22/control-lights-remotely-using-xbee-and-netduino/"/>
   <updated>2012-01-22T00:00:00-06:00</updated>
   <id>https://blog.rousek.name/2012/01/22/control-lights-remotely-using-xbee-and-netduino</id>
   <content type="html">&lt;p&gt;I’m moving to my own appartment and I want to control lamp and mood light wirelessly. Because I want to extend mood light across whole appartment in future. I have decided to use XBee. Specifically XBee Series 2.&lt;/p&gt;

&lt;p&gt;To start with XBees you need atleast 2 &lt;a href=&quot;http://www.sparkfun.com/products/10414&quot;&gt;XBees&lt;/a&gt;, &lt;a href=&quot;http://www.sparkfun.com/products/9976&quot;&gt;XBee shield&lt;/a&gt; or &lt;a href=&quot;http://www.sparkfun.com/products/8276&quot;&gt;breakout boards&lt;/a&gt; and some sort of USB adapter. For example &lt;a href=&quot;http://www.sparkfun.com/products/8687&quot;&gt;XBee Explorer&lt;/a&gt; or &lt;a href=&quot;http://www.sparkfun.com/products/718&quot;&gt;FT232RL USB to Serial breakout board&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;My setup is&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;2 XBees&lt;/li&gt;
  &lt;li&gt;2 breakout boards&lt;/li&gt;
  &lt;li&gt;FT232RL USB to Serial breakout board&lt;/li&gt;
  &lt;li&gt;NetduinoPlus&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;One of nice features of XBee is availability of 10 I/O pins. This allows XBee to sample sensor data without any other microcontroller. XBee can also send sample only when selected digital input changes. This chapter is not well covered online, so I’ve decided to share my experience.&lt;/p&gt;

&lt;p&gt;First of my XBees is running API Controller firmware, its connected to Netduino via serial port. API firmware allows you to receive I/O data from other XBees, which is exactly what I want. Second one is standalone, only two buttons and one lamp are connected. Its running end device API firmware.&lt;/p&gt;

&lt;p&gt;Lets configure our XBees using Digi’s configuration utility X-CTU.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Controller configuration&lt;/strong&gt;&lt;br /&gt;
ID - 70 // PAN ID - ID of your network&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;End device configuration&lt;/strong&gt;&lt;br /&gt;
ID - 70 // PAN ID - ID of your network&lt;br /&gt;
DH - 13A200 // High part of destination(coordinator) address&lt;br /&gt;
DL - 407A26A8 // Low part of destination(coordinator) address&lt;br /&gt;
D0 - 3 // Port set to digital input&lt;br /&gt;
D1 - 3 // Port set to digital input&lt;br /&gt;
D2 - 4 // Port set to digital output, low&lt;br /&gt;
IC - 3 // Digital I/O change detection, enabled for pins D0 and D1&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Next step is wiring circuit for controller.&lt;/p&gt;

&lt;iframe width=&quot;600&quot; height=&quot;350&quot; frameborder=&quot;0&quot; src=&quot;http://c.circuitbee.com/build/r/schematic-embed.html?id=0000000214&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;And end device.&lt;/p&gt;

&lt;iframe width=&quot;600&quot; height=&quot;350&quot; frameborder=&quot;0&quot; src=&quot;http://c.circuitbee.com/build/r/schematic-embed.html?id=0000000215&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;Only obstacle on our way to sucess is code to learn Netduino how to talk with xBee. As I already mentioned I have decided to use API mode.&lt;/p&gt;

&lt;p&gt;I’m using modified Asynchronus API XBee library from &lt;a href=&quot;http://grommet.codeplex.com/&quot; title=&quot;Link to Codeplex&quot;&gt;Grommet&lt;/a&gt;. My version is hosted on &lt;a href=&quot;https://github.com/stlk/XBee&quot; title=&quot;Link to GitHub&quot;&gt;GitHub&lt;/a&gt;, this version is modified to work with limited rescources of Netduino and more importantly to fulfill my needs. Because I have only one end device its address is hardcoded in source code. This will change sooner or later.&lt;/p&gt;

&lt;p&gt;To setup the library open XBee.cs and modify &lt;em&gt;ID of recipient&lt;/em&gt; as shown in example below. Serial number of my xBee end device is 0013A200407126AA. (&lt;strong&gt;EDIT:&lt;/strong&gt; This is no longer needed)&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;private readonly byte[] _txDataBase = new byte[] {
    0x0, // frame type
    0x1, // frame id, set to zero for no reply
    // ID of recipient, or use 0xFFFF for broadcast 
    0x0,
    0x13,
    0xA2,
    0x0,
    0x40,
    0x7A,
    0x26,
    0xAA,
    // 16 bit of recipient or 0xFFFE if unknown
    0xFF,
    0xFE
};
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Last thing I have prepared for you are some &lt;a href=&quot;https://github.com/stlk/XBee/blob/master/Examples/Example.cs&quot;&gt;examples&lt;/a&gt;.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>Netduino binary clock with PCF8574</title>
   <link href="https://blog.rousek.name/2011/10/28/netduino-binary-clock-with-pcf8574/"/>
   <updated>2011-10-28T00:00:00-05:00</updated>
   <id>https://blog.rousek.name/2011/10/28/netduino-binary-clock-with-pcf8574</id>
   <content type="html">&lt;p&gt;Recently I found yet another binary clock and I realised that it might be nice way to try I&lt;sup&gt;2&lt;/sup&gt;C expander &lt;strong&gt;PCF8574&lt;/strong&gt;. &lt;a href=&quot;http://www.gme.cz/i-o-obvody-multifunkcni-periferie/pcf8574p-p433-053/&quot; title=&quot;Link to czech shop&quot;&gt;PCF8574&lt;/a&gt; is cheap and easy to use 8bit I&lt;sup&gt;2&lt;/sup&gt;C expander. Schematic below shows the minute part of circuit. Hour part is exactly the same except you can leave out one LED.&lt;/p&gt;

&lt;iframe width=&quot;600&quot; height=&quot;350&quot; frameborder=&quot;0&quot; src=&quot;http://c.circuitbee.com/build/r/schematic-embed.html?id=0000000192&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;There are two points that I’d like to highlight. When controlling LEDs with this chip you dont need to use resistors. And secondly this chip is current sink which means we need to send 1 to turn LED off and 0 to turn it on.&lt;/p&gt;

&lt;p&gt;So now we have the circuit, but how to feed it with data? Code below handles conversion of number to pseudo binary representation.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-cpp&quot; data-lang=&quot;cpp&quot;&gt;    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;digit2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;intVal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// calculate 2nd digit&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;byteVal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;digit2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// convert to byte&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;intVal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;digit2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// if number is higher than 9&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;intVal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// divide by 10 to get single digit&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;byteVal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;intVal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// shift first digit by 4 bits(for example 00000001 becomes 00010000)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;byteVal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// invert value, explained earlier&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;With data to send we just need to find out how to send them. I&lt;sup&gt;2&lt;/sup&gt;C communication examples can be found almost everywhere so I will explain only values. Adress is determinated by pins A&lt;sub&gt;0&lt;/sub&gt;, A&lt;sub&gt;1&lt;/sub&gt;, A&lt;sub&gt;2&lt;/sub&gt;. Binary representation is 0100A&lt;sub&gt;2&lt;/sub&gt;A&lt;sub&gt;1&lt;/sub&gt;A&lt;sub&gt;0&lt;/sub&gt;. With all pins connected to GND we get 0100000 which is 20 in hexadecimal.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-cpp&quot; data-lang=&quot;cpp&quot;&gt;    &lt;span class=&quot;c1&quot;&gt;// 0x20 is address in hexadecimal format, 100 is maximal frequency for this chip in kilohertz&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Configuration&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;configChip1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Configuration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i2cbus&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;I2CDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;configChip1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i2cbus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;I2CTransaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xact&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;I2CTransaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;                  
            &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CreateWriteTransaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;i2cbus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xact&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Finally, here is &lt;a href=&quot;/public/binary_clock.jpg&quot;&gt;prototype&lt;/a&gt; on breadboard and whole class I use in my binary clock.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-cpp&quot; data-lang=&quot;cpp&quot;&gt;    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;BinaryClock&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Configuration&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;configChip1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Configuration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// all three connected to GND&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Configuration&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;configChip2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Configuration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x21&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// 1st one connected to 5V, rest to GND&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_i2cbus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BinaryClock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;_i2cbus&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;configChip1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DateTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;SendByte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IntToByte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Hour&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;configChip1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;SendByte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IntToByte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Minute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;configChip2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SendByte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Configuration&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_i2cbus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;_i2cbus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Config&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

                &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;I2CTransaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xact&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;I2CTransaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;                  
                    &lt;span class=&quot;n&quot;&gt;I2CDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CreateWriteTransaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

                &lt;span class=&quot;n&quot;&gt;_i2cbus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xact&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IntToByte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;intVal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;digit2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;intVal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;byteVal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;digit2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;intVal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;digit2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;intVal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;byteVal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;intVal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;byteVal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</content>
 </entry>
 

</feed>
