<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="/public/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link href="http://gmpg.org/xfn/11" rel="profile">

    <title>
      Shopify - Fakturoid: Variabilní symbol z externího systému &middot; 
      Zápisník Josefa Rouska
    </title>

    <meta content="Zápisník Josefa Rouska" property="og:site_name">
    
      <meta content="Shopify - Fakturoid: Variabilní symbol z externího systému" property="og:title">
    
    
      <meta content="article" property="og:type">
      <meta property="article:author" content="https://www.facebook.com/josef.rousek" />
    
    
      <meta name="description" content="Máte systém na zpracování objednávek generující vlastní čísla objednávek a potřebujete použít toto číslo jako variabilní symbol?">
      <meta content="Máte systém na zpracování objednávek generující vlastní čísla objednávek a potřebujete použít toto číslo jako variabilní symbol?" property="og:description">
    
    
      <meta content="https://blog.rousek.name/2018/05/22/variabilni-symbol-z-externiho-systemu/" property="og:url">
    
    
      <meta content="2018-05-22T00:00:00-05:00" property="article:published_time">
    
    
      <meta content="http://blog.rousek.name/public/variable-symbol-settings.png" property="og:image">
    

    <!-- CSS -->
    <link rel="stylesheet" href="/public/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400italic,400,600,700|Abril+Fatface&subset=latin,latin-ext">

    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/public/favicon.png">

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  </head>
  <body>

    <header class="masthead">
      <div class="masthead-inner">
        <h1><a href="/">Zápisník Josefa Rouska</a></h1>
        <p class="lead">Python a React.js programátor, zaměřený na Shopify integrace</p>

        <div class="colophon">
          <ul class="colophon-links">
            <li><a href="https://rousek.name/">about</a></li>
            <li><a href="https://github.com/stlk">github</a></li>
            <li><a href="https://twitter.com/josefrousek">twitter</a></li>
          </ul>
        </div>

      </div>
    </header>

    <div class="content container">
      <div class="post">
  <h1>Shopify - Fakturoid: Variabilní symbol z externího systému</h1>
  <span class="post-date">22 May 2018</span>
  <blockquote>
  <p>Tento článek se vztahuje k integraci propojující <a href="https://apps.shopify.com/fakturoid-invoices">Shopify a Fakturoid.cz</a>.</p>
</blockquote>

<p>Máte systém na zpracování objednávek generující vlastní čísla objednávek a potřebujete použít toto číslo jako variabilní symbol? Nově je možné použít atributy uložené v <code class="highlighter-rouge">note_attributes</code> jako variabilní symbol na faktuře. Tento atribut má několik názvů v závislosti na místě použití.</p>

<p>Celý proces začíná v nákupním košíku, kde je možné pomocí skrytého <code class="highlighter-rouge">input</code> elementu nastavit <a href="https://help.shopify.com/themes/customization/cart/get-more-information-with-cart-attributes#sectioned-themes">Cart attribute</a>.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"attributes[shopify_fakturoid_variable_symbol]"</span> <span class="na">value=</span><span class="s">"{{ cart.attributes["</span><span class="na">shopify_fakturoid_variable_symbol</span><span class="err">"]</span> <span class="err">}}"</span><span class="nt">&gt;</span></code></pre></figure>

<p>Pro složitější aplikace je také možné použít <a href="https://help.shopify.com/themes/development/getting-started/using-ajax-api#update-cart">Shopify Ajax API</a>.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">jQuery</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">/cart/update.js</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">attributes</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">shopify_fakturoid_variable_symbol</span><span class="p">:</span> <span class="dl">'</span><span class="s1">123456789</span><span class="dl">'</span>
  <span class="p">}</span>
<span class="p">})</span></code></pre></figure>

<p>Tento atribut se zobrazí v sekci <strong>Additional details</strong> v detailu objednávky v administraci Shopify.</p>

<p class="post__image-center">
  <img src="/public/variable-symbol-aditional-details.png" alt="" class="post__image post__image-full-width" />
</p>

<p>Posledním krokem je zobrazení instrukcí k platbě. K tomuto účelu je možné využít notifikační e-mail <em>Order confirmation</em>.</p>

<blockquote>
  <p>Návod předpokládá, že máte v sekci <em>Settings &gt; Payments &gt; Manual payments</em> zapnutou platbu s názvem <em>Bank Deposit</em>.</p>
</blockquote>

<p><a href="/public/order-confirmation.png" target="_blank">
  <img src="/public/order-confirmation.png" alt="" class="post__image post__image-full-width" />
</a></p>

<p>V šabloně najděte sekci <code class="highlighter-rouge">&lt;h4&gt;Payment method&lt;/h4&gt;</code>, konkrétně <code class="highlighter-rouge">{{ transaction.gateway | replace: "_", " "...</code>. Za <code class="highlighter-rouge">{% endif %}</code> po tomto výrazu vložte kód uvozený <code class="highlighter-rouge">&lt;!-- Platební informace --&gt;</code> a <code class="highlighter-rouge">&lt;!-- / Platební informace --&gt;</code> dle příkladu.</p>

<figure class="highlight"><pre><code class="language-liquid" data-lang="liquid">&lt;!-- Platební informace --&gt;
<span class="p">{%</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="nv">transaction</span><span class="p">.</span><span class="nv">gateway</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Bank Deposit"</span><span class="w"> </span><span class="p">%}</span>
&lt;p class="customer-info__item-content"&gt;
    &lt;strong&gt;Číslo účtu:&lt;/strong&gt; 123457/0000
&lt;/p&gt;
&lt;p class="customer-info__item-content"&gt;
    &lt;strong&gt;Variabilní symbol:&lt;/strong&gt;
    <span class="p">{%</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="nv">order</span><span class="p">.</span><span class="nv">attributes</span><span class="w"> </span><span class="p">%}</span>
        <span class="p">{%</span><span class="w"> </span><span class="nt">for</span><span class="w"> </span><span class="nv">attribute</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">order.attributes</span><span class="w"> </span><span class="p">%}</span>
            <span class="p">{%</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="nv">attribute</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="nv">first</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"shopify_fakturoid_variable_symbol"</span><span class="w"> </span><span class="p">%}</span>
                <span class="p">{{</span><span class="w"> </span><span class="nv">attribute</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nf">last</span><span class="w"> </span><span class="p">}}</span>
            <span class="p">{%</span><span class="w"> </span><span class="kr">endif</span><span class="w"> </span><span class="p">%}</span>
        <span class="p">{%</span><span class="w"> </span><span class="nt">endfor</span><span class="w"> </span><span class="p">%}</span>
    <span class="p">{%</span><span class="w"> </span><span class="kr">endif</span><span class="w"> </span><span class="p">%}</span>
&lt;/p&gt;
<span class="p">{%</span><span class="w"> </span><span class="kr">endif</span><span class="w"> </span><span class="p">%}</span>
&lt;!-- / Platební informace --&gt;</code></pre></figure>

<h3 id="nastavení-aplikace">Nastavení aplikace</h3>

<p>Pro aktivaci této funkce stačí nastavit název atributu v sekci <strong>Custom Variable symbol</strong>.</p>

<p class="post__image-center">
  <img src="/public/variable-symbol-settings.png" alt="" class="post__image post__image-full-width" />
</p>

<p>Více o automatizaci platby převodem se dozvíte v článku <a href="/2017/07/03/automatizace-platby-prevodem-na-shopify/">Automatizace platby převodem na Shopify pomocí Fakturoidu</a>.</p>


</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2020/08/09/high-speed-request-filtering-using-cloudflare-workers/">
            Hi-speed request filtering using Cloudflare Workers
            <small>09 Aug 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/07/16/pipenv-is-great/">
            Pipenv is great
            <small>16 Jul 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/03/28/my-2019/">
            My year 2019
            <small>28 Mar 2020</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

    </div>


    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-485461-11"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() { dataLayer.push(arguments); }
      gtag('js', new Date());

      gtag('config', 'UA-485461-11');
    </script>



  </body>
</html>
